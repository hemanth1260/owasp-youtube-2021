[
    {
        "check_type": "terraform",
        "results": {
            "failed_checks": [
                {
                    "check_id": "CKV_AWS_161",
                    "bc_check_id": null,
                    "check_name": "Ensure RDS database has IAM authentication enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "iam_database_authentication_enabled"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_db_instance\" \"default\" {\n"
                        ],
                        [
                            2,
                            "  name                   = var.dbname\n"
                        ],
                        [
                            3,
                            "  engine                 = \"mysql\"\n"
                        ],
                        [
                            4,
                            "  option_group_name      = aws_db_option_group.default.name\n"
                        ],
                        [
                            5,
                            "  parameter_group_name   = aws_db_parameter_group.default.name\n"
                        ],
                        [
                            6,
                            "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"
                        ],
                        [
                            7,
                            "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"
                        ],
                        [
                            8,
                            "\n"
                        ],
                        [
                            9,
                            "  identifier              = \"rds-${local.resource_prefix.value}\"\n"
                        ],
                        [
                            10,
                            "  engine_version          = \"8.0\" # Latest major version \n"
                        ],
                        [
                            11,
                            "  instance_class          = \"db.t3.micro\"\n"
                        ],
                        [
                            12,
                            "  allocated_storage       = \"20\"\n"
                        ],
                        [
                            13,
                            "  username                = \"admin\"\n"
                        ],
                        [
                            14,
                            "  password                = var.password\n"
                        ],
                        [
                            15,
                            "  apply_immediately       = true\n"
                        ],
                        [
                            16,
                            "  multi_az                = false\n"
                        ],
                        [
                            17,
                            "  backup_retention_period = 0\n"
                        ],
                        [
                            18,
                            "  storage_encrypted       = false\n"
                        ],
                        [
                            19,
                            "  skip_final_snapshot     = true\n"
                        ],
                        [
                            20,
                            "  monitoring_interval     = 0\n"
                        ],
                        [
                            21,
                            "  publicly_accessible     = true\n"
                        ],
                        [
                            22,
                            "\n"
                        ],
                        [
                            23,
                            "  tags = merge({\n"
                        ],
                        [
                            24,
                            "    Name        = \"${local.resource_prefix.value}-rds\"\n"
                        ],
                        [
                            25,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            26,
                            "    }, {\n"
                        ],
                        [
                            27,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            28,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            29,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            30,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            31,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            32,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            33,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            34,
                            "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"
                        ],
                        [
                            35,
                            "  })\n"
                        ],
                        [
                            36,
                            "\n"
                        ],
                        [
                            37,
                            "  # Ignore password changes from tf plan diff\n"
                        ],
                        [
                            38,
                            "  lifecycle {\n"
                        ],
                        [
                            39,
                            "    ignore_changes = [\"password\"]\n"
                        ],
                        [
                            40,
                            "  }\n"
                        ],
                        [
                            41,
                            "}\n"
                        ]
                    ],
                    "file_path": "/db-app.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                    "repo_file_path": "/terragoat/terraform/aws/db-app.tf",
                    "file_line_range": [
                        1,
                        41
                    ],
                    "resource": "aws_db_instance.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.RDSIAMAuthentication",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-rds",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "name": [
                            {
                                "type": "variable",
                                "name": "dbname",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "password": [
                            {
                                "type": "variable",
                                "name": "password",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "identifier": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "option_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_option_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "parameter_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_parameter_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "db_subnet_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_subnet_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_157",
                    "bc_check_id": null,
                    "check_name": "Ensure that RDS instances have Multi-AZ enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "multi_az"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_db_instance\" \"default\" {\n"
                        ],
                        [
                            2,
                            "  name                   = var.dbname\n"
                        ],
                        [
                            3,
                            "  engine                 = \"mysql\"\n"
                        ],
                        [
                            4,
                            "  option_group_name      = aws_db_option_group.default.name\n"
                        ],
                        [
                            5,
                            "  parameter_group_name   = aws_db_parameter_group.default.name\n"
                        ],
                        [
                            6,
                            "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"
                        ],
                        [
                            7,
                            "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"
                        ],
                        [
                            8,
                            "\n"
                        ],
                        [
                            9,
                            "  identifier              = \"rds-${local.resource_prefix.value}\"\n"
                        ],
                        [
                            10,
                            "  engine_version          = \"8.0\" # Latest major version \n"
                        ],
                        [
                            11,
                            "  instance_class          = \"db.t3.micro\"\n"
                        ],
                        [
                            12,
                            "  allocated_storage       = \"20\"\n"
                        ],
                        [
                            13,
                            "  username                = \"admin\"\n"
                        ],
                        [
                            14,
                            "  password                = var.password\n"
                        ],
                        [
                            15,
                            "  apply_immediately       = true\n"
                        ],
                        [
                            16,
                            "  multi_az                = false\n"
                        ],
                        [
                            17,
                            "  backup_retention_period = 0\n"
                        ],
                        [
                            18,
                            "  storage_encrypted       = false\n"
                        ],
                        [
                            19,
                            "  skip_final_snapshot     = true\n"
                        ],
                        [
                            20,
                            "  monitoring_interval     = 0\n"
                        ],
                        [
                            21,
                            "  publicly_accessible     = true\n"
                        ],
                        [
                            22,
                            "\n"
                        ],
                        [
                            23,
                            "  tags = merge({\n"
                        ],
                        [
                            24,
                            "    Name        = \"${local.resource_prefix.value}-rds\"\n"
                        ],
                        [
                            25,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            26,
                            "    }, {\n"
                        ],
                        [
                            27,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            28,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            29,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            30,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            31,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            32,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            33,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            34,
                            "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"
                        ],
                        [
                            35,
                            "  })\n"
                        ],
                        [
                            36,
                            "\n"
                        ],
                        [
                            37,
                            "  # Ignore password changes from tf plan diff\n"
                        ],
                        [
                            38,
                            "  lifecycle {\n"
                        ],
                        [
                            39,
                            "    ignore_changes = [\"password\"]\n"
                        ],
                        [
                            40,
                            "  }\n"
                        ],
                        [
                            41,
                            "}\n"
                        ]
                    ],
                    "file_path": "/db-app.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                    "repo_file_path": "/terragoat/terraform/aws/db-app.tf",
                    "file_line_range": [
                        1,
                        41
                    ],
                    "resource": "aws_db_instance.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.RDSMultiAZEnabled",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-rds",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "name": [
                            {
                                "type": "variable",
                                "name": "dbname",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "password": [
                            {
                                "type": "variable",
                                "name": "password",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "identifier": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "option_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_option_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "parameter_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_parameter_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "db_subnet_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_subnet_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_129",
                    "bc_check_id": null,
                    "check_name": "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "enabled_cloudwatch_logs_exports/[0]/[0]"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_db_instance\" \"default\" {\n"
                        ],
                        [
                            2,
                            "  name                   = var.dbname\n"
                        ],
                        [
                            3,
                            "  engine                 = \"mysql\"\n"
                        ],
                        [
                            4,
                            "  option_group_name      = aws_db_option_group.default.name\n"
                        ],
                        [
                            5,
                            "  parameter_group_name   = aws_db_parameter_group.default.name\n"
                        ],
                        [
                            6,
                            "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"
                        ],
                        [
                            7,
                            "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"
                        ],
                        [
                            8,
                            "\n"
                        ],
                        [
                            9,
                            "  identifier              = \"rds-${local.resource_prefix.value}\"\n"
                        ],
                        [
                            10,
                            "  engine_version          = \"8.0\" # Latest major version \n"
                        ],
                        [
                            11,
                            "  instance_class          = \"db.t3.micro\"\n"
                        ],
                        [
                            12,
                            "  allocated_storage       = \"20\"\n"
                        ],
                        [
                            13,
                            "  username                = \"admin\"\n"
                        ],
                        [
                            14,
                            "  password                = var.password\n"
                        ],
                        [
                            15,
                            "  apply_immediately       = true\n"
                        ],
                        [
                            16,
                            "  multi_az                = false\n"
                        ],
                        [
                            17,
                            "  backup_retention_period = 0\n"
                        ],
                        [
                            18,
                            "  storage_encrypted       = false\n"
                        ],
                        [
                            19,
                            "  skip_final_snapshot     = true\n"
                        ],
                        [
                            20,
                            "  monitoring_interval     = 0\n"
                        ],
                        [
                            21,
                            "  publicly_accessible     = true\n"
                        ],
                        [
                            22,
                            "\n"
                        ],
                        [
                            23,
                            "  tags = merge({\n"
                        ],
                        [
                            24,
                            "    Name        = \"${local.resource_prefix.value}-rds\"\n"
                        ],
                        [
                            25,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            26,
                            "    }, {\n"
                        ],
                        [
                            27,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            28,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            29,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            30,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            31,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            32,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            33,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            34,
                            "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"
                        ],
                        [
                            35,
                            "  })\n"
                        ],
                        [
                            36,
                            "\n"
                        ],
                        [
                            37,
                            "  # Ignore password changes from tf plan diff\n"
                        ],
                        [
                            38,
                            "  lifecycle {\n"
                        ],
                        [
                            39,
                            "    ignore_changes = [\"password\"]\n"
                        ],
                        [
                            40,
                            "  }\n"
                        ],
                        [
                            41,
                            "}\n"
                        ]
                    ],
                    "file_path": "/db-app.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                    "repo_file_path": "/terragoat/terraform/aws/db-app.tf",
                    "file_line_range": [
                        1,
                        41
                    ],
                    "resource": "aws_db_instance.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.DBInstanceLogging",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-rds",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "name": [
                            {
                                "type": "variable",
                                "name": "dbname",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "password": [
                            {
                                "type": "variable",
                                "name": "password",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "identifier": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "option_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_option_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "parameter_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_parameter_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "db_subnet_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_subnet_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_17",
                    "bc_check_id": null,
                    "check_name": "Ensure all data stored in RDS is not publicly accessible",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "publicly_accessible"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_db_instance\" \"default\" {\n"
                        ],
                        [
                            2,
                            "  name                   = var.dbname\n"
                        ],
                        [
                            3,
                            "  engine                 = \"mysql\"\n"
                        ],
                        [
                            4,
                            "  option_group_name      = aws_db_option_group.default.name\n"
                        ],
                        [
                            5,
                            "  parameter_group_name   = aws_db_parameter_group.default.name\n"
                        ],
                        [
                            6,
                            "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"
                        ],
                        [
                            7,
                            "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"
                        ],
                        [
                            8,
                            "\n"
                        ],
                        [
                            9,
                            "  identifier              = \"rds-${local.resource_prefix.value}\"\n"
                        ],
                        [
                            10,
                            "  engine_version          = \"8.0\" # Latest major version \n"
                        ],
                        [
                            11,
                            "  instance_class          = \"db.t3.micro\"\n"
                        ],
                        [
                            12,
                            "  allocated_storage       = \"20\"\n"
                        ],
                        [
                            13,
                            "  username                = \"admin\"\n"
                        ],
                        [
                            14,
                            "  password                = var.password\n"
                        ],
                        [
                            15,
                            "  apply_immediately       = true\n"
                        ],
                        [
                            16,
                            "  multi_az                = false\n"
                        ],
                        [
                            17,
                            "  backup_retention_period = 0\n"
                        ],
                        [
                            18,
                            "  storage_encrypted       = false\n"
                        ],
                        [
                            19,
                            "  skip_final_snapshot     = true\n"
                        ],
                        [
                            20,
                            "  monitoring_interval     = 0\n"
                        ],
                        [
                            21,
                            "  publicly_accessible     = true\n"
                        ],
                        [
                            22,
                            "\n"
                        ],
                        [
                            23,
                            "  tags = merge({\n"
                        ],
                        [
                            24,
                            "    Name        = \"${local.resource_prefix.value}-rds\"\n"
                        ],
                        [
                            25,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            26,
                            "    }, {\n"
                        ],
                        [
                            27,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            28,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            29,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            30,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            31,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            32,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            33,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            34,
                            "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"
                        ],
                        [
                            35,
                            "  })\n"
                        ],
                        [
                            36,
                            "\n"
                        ],
                        [
                            37,
                            "  # Ignore password changes from tf plan diff\n"
                        ],
                        [
                            38,
                            "  lifecycle {\n"
                        ],
                        [
                            39,
                            "    ignore_changes = [\"password\"]\n"
                        ],
                        [
                            40,
                            "  }\n"
                        ],
                        [
                            41,
                            "}\n"
                        ]
                    ],
                    "file_path": "/db-app.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                    "repo_file_path": "/terragoat/terraform/aws/db-app.tf",
                    "file_line_range": [
                        1,
                        41
                    ],
                    "resource": "aws_db_instance.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.RDSPubliclyAccessible",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-rds",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "name": [
                            {
                                "type": "variable",
                                "name": "dbname",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "password": [
                            {
                                "type": "variable",
                                "name": "password",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "identifier": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "option_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_option_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "parameter_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_parameter_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "db_subnet_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_subnet_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_118",
                    "bc_check_id": null,
                    "check_name": "Ensure that enhanced monitoring is enabled for Amazon RDS instances",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "monitoring_interval"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_db_instance\" \"default\" {\n"
                        ],
                        [
                            2,
                            "  name                   = var.dbname\n"
                        ],
                        [
                            3,
                            "  engine                 = \"mysql\"\n"
                        ],
                        [
                            4,
                            "  option_group_name      = aws_db_option_group.default.name\n"
                        ],
                        [
                            5,
                            "  parameter_group_name   = aws_db_parameter_group.default.name\n"
                        ],
                        [
                            6,
                            "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"
                        ],
                        [
                            7,
                            "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"
                        ],
                        [
                            8,
                            "\n"
                        ],
                        [
                            9,
                            "  identifier              = \"rds-${local.resource_prefix.value}\"\n"
                        ],
                        [
                            10,
                            "  engine_version          = \"8.0\" # Latest major version \n"
                        ],
                        [
                            11,
                            "  instance_class          = \"db.t3.micro\"\n"
                        ],
                        [
                            12,
                            "  allocated_storage       = \"20\"\n"
                        ],
                        [
                            13,
                            "  username                = \"admin\"\n"
                        ],
                        [
                            14,
                            "  password                = var.password\n"
                        ],
                        [
                            15,
                            "  apply_immediately       = true\n"
                        ],
                        [
                            16,
                            "  multi_az                = false\n"
                        ],
                        [
                            17,
                            "  backup_retention_period = 0\n"
                        ],
                        [
                            18,
                            "  storage_encrypted       = false\n"
                        ],
                        [
                            19,
                            "  skip_final_snapshot     = true\n"
                        ],
                        [
                            20,
                            "  monitoring_interval     = 0\n"
                        ],
                        [
                            21,
                            "  publicly_accessible     = true\n"
                        ],
                        [
                            22,
                            "\n"
                        ],
                        [
                            23,
                            "  tags = merge({\n"
                        ],
                        [
                            24,
                            "    Name        = \"${local.resource_prefix.value}-rds\"\n"
                        ],
                        [
                            25,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            26,
                            "    }, {\n"
                        ],
                        [
                            27,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            28,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            29,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            30,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            31,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            32,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            33,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            34,
                            "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"
                        ],
                        [
                            35,
                            "  })\n"
                        ],
                        [
                            36,
                            "\n"
                        ],
                        [
                            37,
                            "  # Ignore password changes from tf plan diff\n"
                        ],
                        [
                            38,
                            "  lifecycle {\n"
                        ],
                        [
                            39,
                            "    ignore_changes = [\"password\"]\n"
                        ],
                        [
                            40,
                            "  }\n"
                        ],
                        [
                            41,
                            "}\n"
                        ]
                    ],
                    "file_path": "/db-app.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                    "repo_file_path": "/terragoat/terraform/aws/db-app.tf",
                    "file_line_range": [
                        1,
                        41
                    ],
                    "resource": "aws_db_instance.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.RDSEnhancedMonitorEnabled",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-rds",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "name": [
                            {
                                "type": "variable",
                                "name": "dbname",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "password": [
                            {
                                "type": "variable",
                                "name": "password",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "identifier": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "option_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_option_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "parameter_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_parameter_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "db_subnet_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_subnet_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_16",
                    "bc_check_id": null,
                    "check_name": "Ensure all data stored in the RDS is securely encrypted at rest",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "storage_encrypted"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_db_instance\" \"default\" {\n"
                        ],
                        [
                            2,
                            "  name                   = var.dbname\n"
                        ],
                        [
                            3,
                            "  engine                 = \"mysql\"\n"
                        ],
                        [
                            4,
                            "  option_group_name      = aws_db_option_group.default.name\n"
                        ],
                        [
                            5,
                            "  parameter_group_name   = aws_db_parameter_group.default.name\n"
                        ],
                        [
                            6,
                            "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"
                        ],
                        [
                            7,
                            "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"
                        ],
                        [
                            8,
                            "\n"
                        ],
                        [
                            9,
                            "  identifier              = \"rds-${local.resource_prefix.value}\"\n"
                        ],
                        [
                            10,
                            "  engine_version          = \"8.0\" # Latest major version \n"
                        ],
                        [
                            11,
                            "  instance_class          = \"db.t3.micro\"\n"
                        ],
                        [
                            12,
                            "  allocated_storage       = \"20\"\n"
                        ],
                        [
                            13,
                            "  username                = \"admin\"\n"
                        ],
                        [
                            14,
                            "  password                = var.password\n"
                        ],
                        [
                            15,
                            "  apply_immediately       = true\n"
                        ],
                        [
                            16,
                            "  multi_az                = false\n"
                        ],
                        [
                            17,
                            "  backup_retention_period = 0\n"
                        ],
                        [
                            18,
                            "  storage_encrypted       = false\n"
                        ],
                        [
                            19,
                            "  skip_final_snapshot     = true\n"
                        ],
                        [
                            20,
                            "  monitoring_interval     = 0\n"
                        ],
                        [
                            21,
                            "  publicly_accessible     = true\n"
                        ],
                        [
                            22,
                            "\n"
                        ],
                        [
                            23,
                            "  tags = merge({\n"
                        ],
                        [
                            24,
                            "    Name        = \"${local.resource_prefix.value}-rds\"\n"
                        ],
                        [
                            25,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            26,
                            "    }, {\n"
                        ],
                        [
                            27,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            28,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            29,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            30,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            31,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            32,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            33,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            34,
                            "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"
                        ],
                        [
                            35,
                            "  })\n"
                        ],
                        [
                            36,
                            "\n"
                        ],
                        [
                            37,
                            "  # Ignore password changes from tf plan diff\n"
                        ],
                        [
                            38,
                            "  lifecycle {\n"
                        ],
                        [
                            39,
                            "    ignore_changes = [\"password\"]\n"
                        ],
                        [
                            40,
                            "  }\n"
                        ],
                        [
                            41,
                            "}\n"
                        ]
                    ],
                    "file_path": "/db-app.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                    "repo_file_path": "/terragoat/terraform/aws/db-app.tf",
                    "file_line_range": [
                        1,
                        41
                    ],
                    "resource": "aws_db_instance.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.RDSEncryption",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-rds",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "name": [
                            {
                                "type": "variable",
                                "name": "dbname",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "password": [
                            {
                                "type": "variable",
                                "name": "password",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "identifier": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "option_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_option_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "parameter_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_parameter_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ],
                        "db_subnet_group_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_db_subnet_group.default",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_23",
                    "bc_check_id": null,
                    "check_name": "Ensure every security groups rule has a description",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            116,
                            "resource \"aws_security_group\" \"default\" {\n"
                        ],
                        [
                            117,
                            "  name   = \"${local.resource_prefix.value}-rds-sg\"\n"
                        ],
                        [
                            118,
                            "  vpc_id = aws_vpc.web_vpc.id\n"
                        ],
                        [
                            119,
                            "\n"
                        ],
                        [
                            120,
                            "  tags = merge({\n"
                        ],
                        [
                            121,
                            "    Name        = \"${local.resource_prefix.value}-rds-sg\"\n"
                        ],
                        [
                            122,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            123,
                            "    }, {\n"
                        ],
                        [
                            124,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            125,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            126,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            127,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            128,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            129,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            130,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            131,
                            "    yor_trace            = \"7b251090-8ac1-4290-bd2e-bf3e16126430\"\n"
                        ],
                        [
                            132,
                            "  })\n"
                        ],
                        [
                            133,
                            "}\n"
                        ]
                    ],
                    "file_path": "/db-app.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                    "repo_file_path": "/terragoat/terraform/aws/db-app.tf",
                    "file_line_range": [
                        116,
                        133
                    ],
                    "resource": "aws_security_group.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-rds-sg",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "7b251090-8ac1-4290-bd2e-bf3e16126430"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_23",
                    "bc_check_id": null,
                    "check_name": "Ensure every security groups rule has a description",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            135,
                            "resource \"aws_security_group_rule\" \"ingress\" {\n"
                        ],
                        [
                            136,
                            "  type              = \"ingress\"\n"
                        ],
                        [
                            137,
                            "  from_port         = \"3306\"\n"
                        ],
                        [
                            138,
                            "  to_port           = \"3306\"\n"
                        ],
                        [
                            139,
                            "  protocol          = \"tcp\"\n"
                        ],
                        [
                            140,
                            "  cidr_blocks       = [\"${aws_vpc.web_vpc.cidr_block}\"]\n"
                        ],
                        [
                            141,
                            "  security_group_id = aws_security_group.default.id\n"
                        ],
                        [
                            142,
                            "}\n"
                        ]
                    ],
                    "file_path": "/db-app.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                    "repo_file_path": "/terragoat/terraform/aws/db-app.tf",
                    "file_line_range": [
                        135,
                        142
                    ],
                    "resource": "aws_security_group_rule.ingress",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "cidr_blocks": [
                            {
                                "type": "resource",
                                "name": "aws_vpc.web_vpc",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ec2.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_23",
                    "bc_check_id": null,
                    "check_name": "Ensure every security groups rule has a description",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            144,
                            "resource \"aws_security_group_rule\" \"egress\" {\n"
                        ],
                        [
                            145,
                            "  type              = \"egress\"\n"
                        ],
                        [
                            146,
                            "  from_port         = 0\n"
                        ],
                        [
                            147,
                            "  to_port           = 0\n"
                        ],
                        [
                            148,
                            "  protocol          = \"-1\"\n"
                        ],
                        [
                            149,
                            "  cidr_blocks       = [\"0.0.0.0/0\"]\n"
                        ],
                        [
                            150,
                            "  security_group_id = \"${aws_security_group.default.id}\"\n"
                        ],
                        [
                            151,
                            "}\n"
                        ]
                    ],
                    "file_path": "/db-app.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                    "repo_file_path": "/terragoat/terraform/aws/db-app.tf",
                    "file_line_range": [
                        144,
                        151
                    ],
                    "resource": "aws_security_group_rule.egress",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null
                },
                {
                    "check_id": "CKV_AWS_79",
                    "bc_check_id": null,
                    "check_name": "Ensure Instance Metadata Service Version 1 is not enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "metadata_options/[0]/http_tokens",
                            "metadata_options/[0]/http_endpoint"
                        ]
                    },
                    "code_block": [
                        [
                            242,
                            "resource \"aws_instance\" \"db_app\" {\n"
                        ],
                        [
                            243,
                            "  # ec2 have plain text secrets in user data\n"
                        ],
                        [
                            244,
                            "  ami                  = data.aws_ami.amazon-linux-2.id\n"
                        ],
                        [
                            245,
                            "  instance_type        = \"t2.nano\"\n"
                        ],
                        [
                            246,
                            "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"
                        ],
                        [
                            247,
                            "\n"
                        ],
                        [
                            248,
                            "  vpc_security_group_ids = [\n"
                        ],
                        [
                            249,
                            "  \"${aws_security_group.web-node.id}\"]\n"
                        ],
                        [
                            250,
                            "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"
                        ],
                        [
                            251,
                            "  user_data = <<EOF\n"
                        ],
                        [
                            252,
                            "#! /bin/bash\n"
                        ],
                        [
                            253,
                            "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"
                        ],
                        [
                            254,
                            "sudo yum -y update\n"
                        ],
                        [
                            255,
                            "sudo yum -y install httpd php php-mysqlnd\n"
                        ],
                        [
                            256,
                            "sudo systemctl enable httpd \n"
                        ],
                        [
                            257,
                            "sudo systemctl start httpd\n"
                        ],
                        [
                            258,
                            "\n"
                        ],
                        [
                            259,
                            "sudo mkdir /var/www/inc\n"
                        ],
                        [
                            260,
                            "cat << EnD > /tmp/dbinfo.inc\n"
                        ],
                        [
                            261,
                            "<?php\n"
                        ],
                        [
                            262,
                            "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"
                        ],
                        [
                            263,
                            "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"
                        ],
                        [
                            264,
                            "define('DB_PASSWORD', '${var.password}');\n"
                        ],
                        [
                            265,
                            "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"
                        ],
                        [
                            266,
                            "?>\n"
                        ],
                        [
                            267,
                            "EnD\n"
                        ],
                        [
                            268,
                            "sudo mv /tmp/dbinfo.inc /var/www/inc \n"
                        ],
                        [
                            269,
                            "sudo chown root:root /var/www/inc/dbinfo.inc\n"
                        ],
                        [
                            270,
                            "\n"
                        ],
                        [
                            271,
                            "cat << EnD > /tmp/index.php\n"
                        ],
                        [
                            272,
                            "<?php include \"../inc/dbinfo.inc\"; ?>\n"
                        ],
                        [
                            273,
                            "<html>\n"
                        ],
                        [
                            274,
                            "<body>\n"
                        ],
                        [
                            275,
                            "<h1>Sample page</h1>\n"
                        ],
                        [
                            276,
                            "<?php\n"
                        ],
                        [
                            277,
                            "\n"
                        ],
                        [
                            278,
                            "  /* Connect to MySQL and select the database. */\n"
                        ],
                        [
                            279,
                            "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"
                        ],
                        [
                            280,
                            "\n"
                        ],
                        [
                            281,
                            "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"
                        ],
                        [
                            282,
                            "\n"
                        ],
                        [
                            283,
                            "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            284,
                            "\n"
                        ],
                        [
                            285,
                            "  /* Ensure that the EMPLOYEES table exists. */\n"
                        ],
                        [
                            286,
                            "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            287,
                            "\n"
                        ],
                        [
                            288,
                            "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"
                        ],
                        [
                            289,
                            "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"
                        ],
                        [
                            290,
                            "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"
                        ],
                        [
                            291,
                            "\n"
                        ],
                        [
                            292,
                            "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"
                        ],
                        [
                            293,
                            "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"
                        ],
                        [
                            294,
                            "  }\n"
                        ],
                        [
                            295,
                            "?>\n"
                        ],
                        [
                            296,
                            "\n"
                        ],
                        [
                            297,
                            "<!-- Input form -->\n"
                        ],
                        [
                            298,
                            "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"
                        ],
                        [
                            299,
                            "  <table border=\"0\">\n"
                        ],
                        [
                            300,
                            "    <tr>\n"
                        ],
                        [
                            301,
                            "      <td>NAME</td>\n"
                        ],
                        [
                            302,
                            "      <td>ADDRESS</td>\n"
                        ],
                        [
                            303,
                            "    </tr>\n"
                        ],
                        [
                            304,
                            "    <tr>\n"
                        ],
                        [
                            305,
                            "      <td>\n"
                        ],
                        [
                            306,
                            "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"
                        ],
                        [
                            307,
                            "      </td>\n"
                        ],
                        [
                            308,
                            "      <td>\n"
                        ],
                        [
                            309,
                            "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"
                        ],
                        [
                            310,
                            "      </td>\n"
                        ],
                        [
                            311,
                            "      <td>\n"
                        ],
                        [
                            312,
                            "        <input type=\"submit\" value=\"Add Data\" />\n"
                        ],
                        [
                            313,
                            "      </td>\n"
                        ],
                        [
                            314,
                            "    </tr>\n"
                        ],
                        [
                            315,
                            "  </table>\n"
                        ],
                        [
                            316,
                            "</form>\n"
                        ],
                        [
                            317,
                            "\n"
                        ],
                        [
                            318,
                            "<!-- Display table data. -->\n"
                        ],
                        [
                            319,
                            "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"
                        ],
                        [
                            320,
                            "  <tr>\n"
                        ],
                        [
                            321,
                            "    <td>ID</td>\n"
                        ],
                        [
                            322,
                            "    <td>NAME</td>\n"
                        ],
                        [
                            323,
                            "    <td>ADDRESS</td>\n"
                        ],
                        [
                            324,
                            "  </tr>\n"
                        ],
                        [
                            325,
                            "\n"
                        ],
                        [
                            326,
                            "<?php\n"
                        ],
                        [
                            327,
                            "\n"
                        ],
                        [
                            328,
                            "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"
                        ],
                        [
                            329,
                            "\n"
                        ],
                        [
                            330,
                            "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"
                        ],
                        [
                            331,
                            "  echo \"<tr>\";\n"
                        ],
                        [
                            332,
                            "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"
                        ],
                        [
                            333,
                            "       \"<td>\",\\$query_data[1], \"</td>\",\n"
                        ],
                        [
                            334,
                            "       \"<td>\",\\$query_data[2], \"</td>\";\n"
                        ],
                        [
                            335,
                            "  echo \"</tr>\";\n"
                        ],
                        [
                            336,
                            "}\n"
                        ],
                        [
                            337,
                            "?>\n"
                        ],
                        [
                            338,
                            "\n"
                        ],
                        [
                            339,
                            "</table>\n"
                        ],
                        [
                            340,
                            "\n"
                        ],
                        [
                            341,
                            "<!-- Clean up. -->\n"
                        ],
                        [
                            342,
                            "<?php\n"
                        ],
                        [
                            343,
                            "\n"
                        ],
                        [
                            344,
                            "  mysqli_free_result(\\$result);\n"
                        ],
                        [
                            345,
                            "  mysqli_close(\\$connection);\n"
                        ],
                        [
                            346,
                            "\n"
                        ],
                        [
                            347,
                            "?>\n"
                        ],
                        [
                            348,
                            "\n"
                        ],
                        [
                            349,
                            "</body>\n"
                        ],
                        [
                            350,
                            "</html>\n"
                        ],
                        [
                            351,
                            "\n"
                        ],
                        [
                            352,
                            "\n"
                        ],
                        [
                            353,
                            "<?php\n"
                        ],
                        [
                            354,
                            "\n"
                        ],
                        [
                            355,
                            "/* Add an employee to the table. */\n"
                        ],
                        [
                            356,
                            "function AddEmployee(\\$connection, \\$name, \\$address) {\n"
                        ],
                        [
                            357,
                            "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"
                        ],
                        [
                            358,
                            "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"
                        ],
                        [
                            359,
                            "\n"
                        ],
                        [
                            360,
                            "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"
                        ],
                        [
                            361,
                            "\n"
                        ],
                        [
                            362,
                            "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"
                        ],
                        [
                            363,
                            "}\n"
                        ],
                        [
                            364,
                            "\n"
                        ],
                        [
                            365,
                            "/* Check whether the table exists and, if not, create it. */\n"
                        ],
                        [
                            366,
                            "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"
                        ],
                        [
                            367,
                            "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"
                        ],
                        [
                            368,
                            "  {\n"
                        ],
                        [
                            369,
                            "     \\$query = \"CREATE TABLE EMPLOYEES (\n"
                        ],
                        [
                            370,
                            "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"
                        ],
                        [
                            371,
                            "         NAME VARCHAR(45),\n"
                        ],
                        [
                            372,
                            "         ADDRESS VARCHAR(90)\n"
                        ],
                        [
                            373,
                            "       )\";\n"
                        ],
                        [
                            374,
                            "\n"
                        ],
                        [
                            375,
                            "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"
                        ],
                        [
                            376,
                            "  }\n"
                        ],
                        [
                            377,
                            "}\n"
                        ],
                        [
                            378,
                            "\n"
                        ],
                        [
                            379,
                            "/* Check for the existence of a table. */\n"
                        ],
                        [
                            380,
                            "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"
                        ],
                        [
                            381,
                            "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"
                        ],
                        [
                            382,
                            "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"
                        ],
                        [
                            383,
                            "\n"
                        ],
                        [
                            384,
                            "  \\$checktable = mysqli_query(\\$connection,\n"
                        ],
                        [
                            385,
                            "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"
                        ],
                        [
                            386,
                            "\n"
                        ],
                        [
                            387,
                            "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"
                        ],
                        [
                            388,
                            "\n"
                        ],
                        [
                            389,
                            "  return false;\n"
                        ],
                        [
                            390,
                            "}\n"
                        ],
                        [
                            391,
                            "?>               \n"
                        ],
                        [
                            392,
                            "EnD\n"
                        ],
                        [
                            393,
                            "\n"
                        ],
                        [
                            394,
                            "sudo mv /tmp/index.php /var/www/html\n"
                        ],
                        [
                            395,
                            "sudo chown root:root /var/www/html/index.php\n"
                        ],
                        [
                            396,
                            "\n"
                        ],
                        [
                            397,
                            "\n"
                        ],
                        [
                            398,
                            "\n"
                        ],
                        [
                            399,
                            "EOF\n"
                        ],
                        [
                            400,
                            "  tags = merge({\n"
                        ],
                        [
                            401,
                            "    Name = \"${local.resource_prefix.value}-dbapp\"\n"
                        ],
                        [
                            402,
                            "    }, {\n"
                        ],
                        [
                            403,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            404,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            405,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            406,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            407,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            408,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            409,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            410,
                            "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"
                        ],
                        [
                            411,
                            "  })\n"
                        ],
                        [
                            412,
                            "}\n"
                        ]
                    ],
                    "file_path": "/db-app.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                    "repo_file_path": "/terragoat/terraform/aws/db-app.tf",
                    "file_line_range": [
                        242,
                        412
                    ],
                    "resource": "aws_instance.db_app",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.IMDSv1Disabled",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-dbapp",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "user_data": [
                            {
                                "type": "variable",
                                "name": "password",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "iam_instance_profile": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_iam_instance_profile.ec2profile",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_126",
                    "bc_check_id": null,
                    "check_name": "Ensure that detailed monitoring is enabled for EC2 instances",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "monitoring"
                        ]
                    },
                    "code_block": [
                        [
                            242,
                            "resource \"aws_instance\" \"db_app\" {\n"
                        ],
                        [
                            243,
                            "  # ec2 have plain text secrets in user data\n"
                        ],
                        [
                            244,
                            "  ami                  = data.aws_ami.amazon-linux-2.id\n"
                        ],
                        [
                            245,
                            "  instance_type        = \"t2.nano\"\n"
                        ],
                        [
                            246,
                            "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"
                        ],
                        [
                            247,
                            "\n"
                        ],
                        [
                            248,
                            "  vpc_security_group_ids = [\n"
                        ],
                        [
                            249,
                            "  \"${aws_security_group.web-node.id}\"]\n"
                        ],
                        [
                            250,
                            "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"
                        ],
                        [
                            251,
                            "  user_data = <<EOF\n"
                        ],
                        [
                            252,
                            "#! /bin/bash\n"
                        ],
                        [
                            253,
                            "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"
                        ],
                        [
                            254,
                            "sudo yum -y update\n"
                        ],
                        [
                            255,
                            "sudo yum -y install httpd php php-mysqlnd\n"
                        ],
                        [
                            256,
                            "sudo systemctl enable httpd \n"
                        ],
                        [
                            257,
                            "sudo systemctl start httpd\n"
                        ],
                        [
                            258,
                            "\n"
                        ],
                        [
                            259,
                            "sudo mkdir /var/www/inc\n"
                        ],
                        [
                            260,
                            "cat << EnD > /tmp/dbinfo.inc\n"
                        ],
                        [
                            261,
                            "<?php\n"
                        ],
                        [
                            262,
                            "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"
                        ],
                        [
                            263,
                            "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"
                        ],
                        [
                            264,
                            "define('DB_PASSWORD', '${var.password}');\n"
                        ],
                        [
                            265,
                            "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"
                        ],
                        [
                            266,
                            "?>\n"
                        ],
                        [
                            267,
                            "EnD\n"
                        ],
                        [
                            268,
                            "sudo mv /tmp/dbinfo.inc /var/www/inc \n"
                        ],
                        [
                            269,
                            "sudo chown root:root /var/www/inc/dbinfo.inc\n"
                        ],
                        [
                            270,
                            "\n"
                        ],
                        [
                            271,
                            "cat << EnD > /tmp/index.php\n"
                        ],
                        [
                            272,
                            "<?php include \"../inc/dbinfo.inc\"; ?>\n"
                        ],
                        [
                            273,
                            "<html>\n"
                        ],
                        [
                            274,
                            "<body>\n"
                        ],
                        [
                            275,
                            "<h1>Sample page</h1>\n"
                        ],
                        [
                            276,
                            "<?php\n"
                        ],
                        [
                            277,
                            "\n"
                        ],
                        [
                            278,
                            "  /* Connect to MySQL and select the database. */\n"
                        ],
                        [
                            279,
                            "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"
                        ],
                        [
                            280,
                            "\n"
                        ],
                        [
                            281,
                            "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"
                        ],
                        [
                            282,
                            "\n"
                        ],
                        [
                            283,
                            "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            284,
                            "\n"
                        ],
                        [
                            285,
                            "  /* Ensure that the EMPLOYEES table exists. */\n"
                        ],
                        [
                            286,
                            "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            287,
                            "\n"
                        ],
                        [
                            288,
                            "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"
                        ],
                        [
                            289,
                            "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"
                        ],
                        [
                            290,
                            "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"
                        ],
                        [
                            291,
                            "\n"
                        ],
                        [
                            292,
                            "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"
                        ],
                        [
                            293,
                            "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"
                        ],
                        [
                            294,
                            "  }\n"
                        ],
                        [
                            295,
                            "?>\n"
                        ],
                        [
                            296,
                            "\n"
                        ],
                        [
                            297,
                            "<!-- Input form -->\n"
                        ],
                        [
                            298,
                            "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"
                        ],
                        [
                            299,
                            "  <table border=\"0\">\n"
                        ],
                        [
                            300,
                            "    <tr>\n"
                        ],
                        [
                            301,
                            "      <td>NAME</td>\n"
                        ],
                        [
                            302,
                            "      <td>ADDRESS</td>\n"
                        ],
                        [
                            303,
                            "    </tr>\n"
                        ],
                        [
                            304,
                            "    <tr>\n"
                        ],
                        [
                            305,
                            "      <td>\n"
                        ],
                        [
                            306,
                            "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"
                        ],
                        [
                            307,
                            "      </td>\n"
                        ],
                        [
                            308,
                            "      <td>\n"
                        ],
                        [
                            309,
                            "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"
                        ],
                        [
                            310,
                            "      </td>\n"
                        ],
                        [
                            311,
                            "      <td>\n"
                        ],
                        [
                            312,
                            "        <input type=\"submit\" value=\"Add Data\" />\n"
                        ],
                        [
                            313,
                            "      </td>\n"
                        ],
                        [
                            314,
                            "    </tr>\n"
                        ],
                        [
                            315,
                            "  </table>\n"
                        ],
                        [
                            316,
                            "</form>\n"
                        ],
                        [
                            317,
                            "\n"
                        ],
                        [
                            318,
                            "<!-- Display table data. -->\n"
                        ],
                        [
                            319,
                            "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"
                        ],
                        [
                            320,
                            "  <tr>\n"
                        ],
                        [
                            321,
                            "    <td>ID</td>\n"
                        ],
                        [
                            322,
                            "    <td>NAME</td>\n"
                        ],
                        [
                            323,
                            "    <td>ADDRESS</td>\n"
                        ],
                        [
                            324,
                            "  </tr>\n"
                        ],
                        [
                            325,
                            "\n"
                        ],
                        [
                            326,
                            "<?php\n"
                        ],
                        [
                            327,
                            "\n"
                        ],
                        [
                            328,
                            "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"
                        ],
                        [
                            329,
                            "\n"
                        ],
                        [
                            330,
                            "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"
                        ],
                        [
                            331,
                            "  echo \"<tr>\";\n"
                        ],
                        [
                            332,
                            "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"
                        ],
                        [
                            333,
                            "       \"<td>\",\\$query_data[1], \"</td>\",\n"
                        ],
                        [
                            334,
                            "       \"<td>\",\\$query_data[2], \"</td>\";\n"
                        ],
                        [
                            335,
                            "  echo \"</tr>\";\n"
                        ],
                        [
                            336,
                            "}\n"
                        ],
                        [
                            337,
                            "?>\n"
                        ],
                        [
                            338,
                            "\n"
                        ],
                        [
                            339,
                            "</table>\n"
                        ],
                        [
                            340,
                            "\n"
                        ],
                        [
                            341,
                            "<!-- Clean up. -->\n"
                        ],
                        [
                            342,
                            "<?php\n"
                        ],
                        [
                            343,
                            "\n"
                        ],
                        [
                            344,
                            "  mysqli_free_result(\\$result);\n"
                        ],
                        [
                            345,
                            "  mysqli_close(\\$connection);\n"
                        ],
                        [
                            346,
                            "\n"
                        ],
                        [
                            347,
                            "?>\n"
                        ],
                        [
                            348,
                            "\n"
                        ],
                        [
                            349,
                            "</body>\n"
                        ],
                        [
                            350,
                            "</html>\n"
                        ],
                        [
                            351,
                            "\n"
                        ],
                        [
                            352,
                            "\n"
                        ],
                        [
                            353,
                            "<?php\n"
                        ],
                        [
                            354,
                            "\n"
                        ],
                        [
                            355,
                            "/* Add an employee to the table. */\n"
                        ],
                        [
                            356,
                            "function AddEmployee(\\$connection, \\$name, \\$address) {\n"
                        ],
                        [
                            357,
                            "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"
                        ],
                        [
                            358,
                            "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"
                        ],
                        [
                            359,
                            "\n"
                        ],
                        [
                            360,
                            "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"
                        ],
                        [
                            361,
                            "\n"
                        ],
                        [
                            362,
                            "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"
                        ],
                        [
                            363,
                            "}\n"
                        ],
                        [
                            364,
                            "\n"
                        ],
                        [
                            365,
                            "/* Check whether the table exists and, if not, create it. */\n"
                        ],
                        [
                            366,
                            "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"
                        ],
                        [
                            367,
                            "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"
                        ],
                        [
                            368,
                            "  {\n"
                        ],
                        [
                            369,
                            "     \\$query = \"CREATE TABLE EMPLOYEES (\n"
                        ],
                        [
                            370,
                            "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"
                        ],
                        [
                            371,
                            "         NAME VARCHAR(45),\n"
                        ],
                        [
                            372,
                            "         ADDRESS VARCHAR(90)\n"
                        ],
                        [
                            373,
                            "       )\";\n"
                        ],
                        [
                            374,
                            "\n"
                        ],
                        [
                            375,
                            "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"
                        ],
                        [
                            376,
                            "  }\n"
                        ],
                        [
                            377,
                            "}\n"
                        ],
                        [
                            378,
                            "\n"
                        ],
                        [
                            379,
                            "/* Check for the existence of a table. */\n"
                        ],
                        [
                            380,
                            "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"
                        ],
                        [
                            381,
                            "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"
                        ],
                        [
                            382,
                            "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"
                        ],
                        [
                            383,
                            "\n"
                        ],
                        [
                            384,
                            "  \\$checktable = mysqli_query(\\$connection,\n"
                        ],
                        [
                            385,
                            "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"
                        ],
                        [
                            386,
                            "\n"
                        ],
                        [
                            387,
                            "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"
                        ],
                        [
                            388,
                            "\n"
                        ],
                        [
                            389,
                            "  return false;\n"
                        ],
                        [
                            390,
                            "}\n"
                        ],
                        [
                            391,
                            "?>               \n"
                        ],
                        [
                            392,
                            "EnD\n"
                        ],
                        [
                            393,
                            "\n"
                        ],
                        [
                            394,
                            "sudo mv /tmp/index.php /var/www/html\n"
                        ],
                        [
                            395,
                            "sudo chown root:root /var/www/html/index.php\n"
                        ],
                        [
                            396,
                            "\n"
                        ],
                        [
                            397,
                            "\n"
                        ],
                        [
                            398,
                            "\n"
                        ],
                        [
                            399,
                            "EOF\n"
                        ],
                        [
                            400,
                            "  tags = merge({\n"
                        ],
                        [
                            401,
                            "    Name = \"${local.resource_prefix.value}-dbapp\"\n"
                        ],
                        [
                            402,
                            "    }, {\n"
                        ],
                        [
                            403,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            404,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            405,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            406,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            407,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            408,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            409,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            410,
                            "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"
                        ],
                        [
                            411,
                            "  })\n"
                        ],
                        [
                            412,
                            "}\n"
                        ]
                    ],
                    "file_path": "/db-app.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                    "repo_file_path": "/terragoat/terraform/aws/db-app.tf",
                    "file_line_range": [
                        242,
                        412
                    ],
                    "resource": "aws_instance.db_app",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.EC2DetailedMonitoringEnabled",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-dbapp",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "user_data": [
                            {
                                "type": "variable",
                                "name": "password",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "iam_instance_profile": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_iam_instance_profile.ec2profile",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_135",
                    "bc_check_id": null,
                    "check_name": "Ensure that EC2 is EBS optimized",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "ebs_optimized"
                        ]
                    },
                    "code_block": [
                        [
                            242,
                            "resource \"aws_instance\" \"db_app\" {\n"
                        ],
                        [
                            243,
                            "  # ec2 have plain text secrets in user data\n"
                        ],
                        [
                            244,
                            "  ami                  = data.aws_ami.amazon-linux-2.id\n"
                        ],
                        [
                            245,
                            "  instance_type        = \"t2.nano\"\n"
                        ],
                        [
                            246,
                            "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"
                        ],
                        [
                            247,
                            "\n"
                        ],
                        [
                            248,
                            "  vpc_security_group_ids = [\n"
                        ],
                        [
                            249,
                            "  \"${aws_security_group.web-node.id}\"]\n"
                        ],
                        [
                            250,
                            "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"
                        ],
                        [
                            251,
                            "  user_data = <<EOF\n"
                        ],
                        [
                            252,
                            "#! /bin/bash\n"
                        ],
                        [
                            253,
                            "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"
                        ],
                        [
                            254,
                            "sudo yum -y update\n"
                        ],
                        [
                            255,
                            "sudo yum -y install httpd php php-mysqlnd\n"
                        ],
                        [
                            256,
                            "sudo systemctl enable httpd \n"
                        ],
                        [
                            257,
                            "sudo systemctl start httpd\n"
                        ],
                        [
                            258,
                            "\n"
                        ],
                        [
                            259,
                            "sudo mkdir /var/www/inc\n"
                        ],
                        [
                            260,
                            "cat << EnD > /tmp/dbinfo.inc\n"
                        ],
                        [
                            261,
                            "<?php\n"
                        ],
                        [
                            262,
                            "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"
                        ],
                        [
                            263,
                            "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"
                        ],
                        [
                            264,
                            "define('DB_PASSWORD', '${var.password}');\n"
                        ],
                        [
                            265,
                            "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"
                        ],
                        [
                            266,
                            "?>\n"
                        ],
                        [
                            267,
                            "EnD\n"
                        ],
                        [
                            268,
                            "sudo mv /tmp/dbinfo.inc /var/www/inc \n"
                        ],
                        [
                            269,
                            "sudo chown root:root /var/www/inc/dbinfo.inc\n"
                        ],
                        [
                            270,
                            "\n"
                        ],
                        [
                            271,
                            "cat << EnD > /tmp/index.php\n"
                        ],
                        [
                            272,
                            "<?php include \"../inc/dbinfo.inc\"; ?>\n"
                        ],
                        [
                            273,
                            "<html>\n"
                        ],
                        [
                            274,
                            "<body>\n"
                        ],
                        [
                            275,
                            "<h1>Sample page</h1>\n"
                        ],
                        [
                            276,
                            "<?php\n"
                        ],
                        [
                            277,
                            "\n"
                        ],
                        [
                            278,
                            "  /* Connect to MySQL and select the database. */\n"
                        ],
                        [
                            279,
                            "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"
                        ],
                        [
                            280,
                            "\n"
                        ],
                        [
                            281,
                            "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"
                        ],
                        [
                            282,
                            "\n"
                        ],
                        [
                            283,
                            "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            284,
                            "\n"
                        ],
                        [
                            285,
                            "  /* Ensure that the EMPLOYEES table exists. */\n"
                        ],
                        [
                            286,
                            "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            287,
                            "\n"
                        ],
                        [
                            288,
                            "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"
                        ],
                        [
                            289,
                            "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"
                        ],
                        [
                            290,
                            "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"
                        ],
                        [
                            291,
                            "\n"
                        ],
                        [
                            292,
                            "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"
                        ],
                        [
                            293,
                            "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"
                        ],
                        [
                            294,
                            "  }\n"
                        ],
                        [
                            295,
                            "?>\n"
                        ],
                        [
                            296,
                            "\n"
                        ],
                        [
                            297,
                            "<!-- Input form -->\n"
                        ],
                        [
                            298,
                            "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"
                        ],
                        [
                            299,
                            "  <table border=\"0\">\n"
                        ],
                        [
                            300,
                            "    <tr>\n"
                        ],
                        [
                            301,
                            "      <td>NAME</td>\n"
                        ],
                        [
                            302,
                            "      <td>ADDRESS</td>\n"
                        ],
                        [
                            303,
                            "    </tr>\n"
                        ],
                        [
                            304,
                            "    <tr>\n"
                        ],
                        [
                            305,
                            "      <td>\n"
                        ],
                        [
                            306,
                            "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"
                        ],
                        [
                            307,
                            "      </td>\n"
                        ],
                        [
                            308,
                            "      <td>\n"
                        ],
                        [
                            309,
                            "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"
                        ],
                        [
                            310,
                            "      </td>\n"
                        ],
                        [
                            311,
                            "      <td>\n"
                        ],
                        [
                            312,
                            "        <input type=\"submit\" value=\"Add Data\" />\n"
                        ],
                        [
                            313,
                            "      </td>\n"
                        ],
                        [
                            314,
                            "    </tr>\n"
                        ],
                        [
                            315,
                            "  </table>\n"
                        ],
                        [
                            316,
                            "</form>\n"
                        ],
                        [
                            317,
                            "\n"
                        ],
                        [
                            318,
                            "<!-- Display table data. -->\n"
                        ],
                        [
                            319,
                            "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"
                        ],
                        [
                            320,
                            "  <tr>\n"
                        ],
                        [
                            321,
                            "    <td>ID</td>\n"
                        ],
                        [
                            322,
                            "    <td>NAME</td>\n"
                        ],
                        [
                            323,
                            "    <td>ADDRESS</td>\n"
                        ],
                        [
                            324,
                            "  </tr>\n"
                        ],
                        [
                            325,
                            "\n"
                        ],
                        [
                            326,
                            "<?php\n"
                        ],
                        [
                            327,
                            "\n"
                        ],
                        [
                            328,
                            "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"
                        ],
                        [
                            329,
                            "\n"
                        ],
                        [
                            330,
                            "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"
                        ],
                        [
                            331,
                            "  echo \"<tr>\";\n"
                        ],
                        [
                            332,
                            "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"
                        ],
                        [
                            333,
                            "       \"<td>\",\\$query_data[1], \"</td>\",\n"
                        ],
                        [
                            334,
                            "       \"<td>\",\\$query_data[2], \"</td>\";\n"
                        ],
                        [
                            335,
                            "  echo \"</tr>\";\n"
                        ],
                        [
                            336,
                            "}\n"
                        ],
                        [
                            337,
                            "?>\n"
                        ],
                        [
                            338,
                            "\n"
                        ],
                        [
                            339,
                            "</table>\n"
                        ],
                        [
                            340,
                            "\n"
                        ],
                        [
                            341,
                            "<!-- Clean up. -->\n"
                        ],
                        [
                            342,
                            "<?php\n"
                        ],
                        [
                            343,
                            "\n"
                        ],
                        [
                            344,
                            "  mysqli_free_result(\\$result);\n"
                        ],
                        [
                            345,
                            "  mysqli_close(\\$connection);\n"
                        ],
                        [
                            346,
                            "\n"
                        ],
                        [
                            347,
                            "?>\n"
                        ],
                        [
                            348,
                            "\n"
                        ],
                        [
                            349,
                            "</body>\n"
                        ],
                        [
                            350,
                            "</html>\n"
                        ],
                        [
                            351,
                            "\n"
                        ],
                        [
                            352,
                            "\n"
                        ],
                        [
                            353,
                            "<?php\n"
                        ],
                        [
                            354,
                            "\n"
                        ],
                        [
                            355,
                            "/* Add an employee to the table. */\n"
                        ],
                        [
                            356,
                            "function AddEmployee(\\$connection, \\$name, \\$address) {\n"
                        ],
                        [
                            357,
                            "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"
                        ],
                        [
                            358,
                            "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"
                        ],
                        [
                            359,
                            "\n"
                        ],
                        [
                            360,
                            "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"
                        ],
                        [
                            361,
                            "\n"
                        ],
                        [
                            362,
                            "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"
                        ],
                        [
                            363,
                            "}\n"
                        ],
                        [
                            364,
                            "\n"
                        ],
                        [
                            365,
                            "/* Check whether the table exists and, if not, create it. */\n"
                        ],
                        [
                            366,
                            "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"
                        ],
                        [
                            367,
                            "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"
                        ],
                        [
                            368,
                            "  {\n"
                        ],
                        [
                            369,
                            "     \\$query = \"CREATE TABLE EMPLOYEES (\n"
                        ],
                        [
                            370,
                            "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"
                        ],
                        [
                            371,
                            "         NAME VARCHAR(45),\n"
                        ],
                        [
                            372,
                            "         ADDRESS VARCHAR(90)\n"
                        ],
                        [
                            373,
                            "       )\";\n"
                        ],
                        [
                            374,
                            "\n"
                        ],
                        [
                            375,
                            "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"
                        ],
                        [
                            376,
                            "  }\n"
                        ],
                        [
                            377,
                            "}\n"
                        ],
                        [
                            378,
                            "\n"
                        ],
                        [
                            379,
                            "/* Check for the existence of a table. */\n"
                        ],
                        [
                            380,
                            "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"
                        ],
                        [
                            381,
                            "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"
                        ],
                        [
                            382,
                            "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"
                        ],
                        [
                            383,
                            "\n"
                        ],
                        [
                            384,
                            "  \\$checktable = mysqli_query(\\$connection,\n"
                        ],
                        [
                            385,
                            "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"
                        ],
                        [
                            386,
                            "\n"
                        ],
                        [
                            387,
                            "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"
                        ],
                        [
                            388,
                            "\n"
                        ],
                        [
                            389,
                            "  return false;\n"
                        ],
                        [
                            390,
                            "}\n"
                        ],
                        [
                            391,
                            "?>               \n"
                        ],
                        [
                            392,
                            "EnD\n"
                        ],
                        [
                            393,
                            "\n"
                        ],
                        [
                            394,
                            "sudo mv /tmp/index.php /var/www/html\n"
                        ],
                        [
                            395,
                            "sudo chown root:root /var/www/html/index.php\n"
                        ],
                        [
                            396,
                            "\n"
                        ],
                        [
                            397,
                            "\n"
                        ],
                        [
                            398,
                            "\n"
                        ],
                        [
                            399,
                            "EOF\n"
                        ],
                        [
                            400,
                            "  tags = merge({\n"
                        ],
                        [
                            401,
                            "    Name = \"${local.resource_prefix.value}-dbapp\"\n"
                        ],
                        [
                            402,
                            "    }, {\n"
                        ],
                        [
                            403,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            404,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            405,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            406,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            407,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            408,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            409,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            410,
                            "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"
                        ],
                        [
                            411,
                            "  })\n"
                        ],
                        [
                            412,
                            "}\n"
                        ]
                    ],
                    "file_path": "/db-app.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                    "repo_file_path": "/terragoat/terraform/aws/db-app.tf",
                    "file_line_range": [
                        242,
                        412
                    ],
                    "resource": "aws_instance.db_app",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.EC2EBSOptimized",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-dbapp",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "user_data": [
                            {
                                "type": "variable",
                                "name": "password",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "iam_instance_profile": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_iam_instance_profile.ec2profile",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_8",
                    "bc_check_id": null,
                    "check_name": "Ensure all data stored in the Launch configuration EBS is securely encrypted",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "*_block_device/[0]/encrypted"
                        ]
                    },
                    "code_block": [
                        [
                            242,
                            "resource \"aws_instance\" \"db_app\" {\n"
                        ],
                        [
                            243,
                            "  # ec2 have plain text secrets in user data\n"
                        ],
                        [
                            244,
                            "  ami                  = data.aws_ami.amazon-linux-2.id\n"
                        ],
                        [
                            245,
                            "  instance_type        = \"t2.nano\"\n"
                        ],
                        [
                            246,
                            "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"
                        ],
                        [
                            247,
                            "\n"
                        ],
                        [
                            248,
                            "  vpc_security_group_ids = [\n"
                        ],
                        [
                            249,
                            "  \"${aws_security_group.web-node.id}\"]\n"
                        ],
                        [
                            250,
                            "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"
                        ],
                        [
                            251,
                            "  user_data = <<EOF\n"
                        ],
                        [
                            252,
                            "#! /bin/bash\n"
                        ],
                        [
                            253,
                            "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"
                        ],
                        [
                            254,
                            "sudo yum -y update\n"
                        ],
                        [
                            255,
                            "sudo yum -y install httpd php php-mysqlnd\n"
                        ],
                        [
                            256,
                            "sudo systemctl enable httpd \n"
                        ],
                        [
                            257,
                            "sudo systemctl start httpd\n"
                        ],
                        [
                            258,
                            "\n"
                        ],
                        [
                            259,
                            "sudo mkdir /var/www/inc\n"
                        ],
                        [
                            260,
                            "cat << EnD > /tmp/dbinfo.inc\n"
                        ],
                        [
                            261,
                            "<?php\n"
                        ],
                        [
                            262,
                            "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"
                        ],
                        [
                            263,
                            "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"
                        ],
                        [
                            264,
                            "define('DB_PASSWORD', '${var.password}');\n"
                        ],
                        [
                            265,
                            "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"
                        ],
                        [
                            266,
                            "?>\n"
                        ],
                        [
                            267,
                            "EnD\n"
                        ],
                        [
                            268,
                            "sudo mv /tmp/dbinfo.inc /var/www/inc \n"
                        ],
                        [
                            269,
                            "sudo chown root:root /var/www/inc/dbinfo.inc\n"
                        ],
                        [
                            270,
                            "\n"
                        ],
                        [
                            271,
                            "cat << EnD > /tmp/index.php\n"
                        ],
                        [
                            272,
                            "<?php include \"../inc/dbinfo.inc\"; ?>\n"
                        ],
                        [
                            273,
                            "<html>\n"
                        ],
                        [
                            274,
                            "<body>\n"
                        ],
                        [
                            275,
                            "<h1>Sample page</h1>\n"
                        ],
                        [
                            276,
                            "<?php\n"
                        ],
                        [
                            277,
                            "\n"
                        ],
                        [
                            278,
                            "  /* Connect to MySQL and select the database. */\n"
                        ],
                        [
                            279,
                            "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"
                        ],
                        [
                            280,
                            "\n"
                        ],
                        [
                            281,
                            "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"
                        ],
                        [
                            282,
                            "\n"
                        ],
                        [
                            283,
                            "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            284,
                            "\n"
                        ],
                        [
                            285,
                            "  /* Ensure that the EMPLOYEES table exists. */\n"
                        ],
                        [
                            286,
                            "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"
                        ],
                        [
                            287,
                            "\n"
                        ],
                        [
                            288,
                            "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"
                        ],
                        [
                            289,
                            "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"
                        ],
                        [
                            290,
                            "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"
                        ],
                        [
                            291,
                            "\n"
                        ],
                        [
                            292,
                            "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"
                        ],
                        [
                            293,
                            "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"
                        ],
                        [
                            294,
                            "  }\n"
                        ],
                        [
                            295,
                            "?>\n"
                        ],
                        [
                            296,
                            "\n"
                        ],
                        [
                            297,
                            "<!-- Input form -->\n"
                        ],
                        [
                            298,
                            "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"
                        ],
                        [
                            299,
                            "  <table border=\"0\">\n"
                        ],
                        [
                            300,
                            "    <tr>\n"
                        ],
                        [
                            301,
                            "      <td>NAME</td>\n"
                        ],
                        [
                            302,
                            "      <td>ADDRESS</td>\n"
                        ],
                        [
                            303,
                            "    </tr>\n"
                        ],
                        [
                            304,
                            "    <tr>\n"
                        ],
                        [
                            305,
                            "      <td>\n"
                        ],
                        [
                            306,
                            "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"
                        ],
                        [
                            307,
                            "      </td>\n"
                        ],
                        [
                            308,
                            "      <td>\n"
                        ],
                        [
                            309,
                            "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"
                        ],
                        [
                            310,
                            "      </td>\n"
                        ],
                        [
                            311,
                            "      <td>\n"
                        ],
                        [
                            312,
                            "        <input type=\"submit\" value=\"Add Data\" />\n"
                        ],
                        [
                            313,
                            "      </td>\n"
                        ],
                        [
                            314,
                            "    </tr>\n"
                        ],
                        [
                            315,
                            "  </table>\n"
                        ],
                        [
                            316,
                            "</form>\n"
                        ],
                        [
                            317,
                            "\n"
                        ],
                        [
                            318,
                            "<!-- Display table data. -->\n"
                        ],
                        [
                            319,
                            "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"
                        ],
                        [
                            320,
                            "  <tr>\n"
                        ],
                        [
                            321,
                            "    <td>ID</td>\n"
                        ],
                        [
                            322,
                            "    <td>NAME</td>\n"
                        ],
                        [
                            323,
                            "    <td>ADDRESS</td>\n"
                        ],
                        [
                            324,
                            "  </tr>\n"
                        ],
                        [
                            325,
                            "\n"
                        ],
                        [
                            326,
                            "<?php\n"
                        ],
                        [
                            327,
                            "\n"
                        ],
                        [
                            328,
                            "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"
                        ],
                        [
                            329,
                            "\n"
                        ],
                        [
                            330,
                            "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"
                        ],
                        [
                            331,
                            "  echo \"<tr>\";\n"
                        ],
                        [
                            332,
                            "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"
                        ],
                        [
                            333,
                            "       \"<td>\",\\$query_data[1], \"</td>\",\n"
                        ],
                        [
                            334,
                            "       \"<td>\",\\$query_data[2], \"</td>\";\n"
                        ],
                        [
                            335,
                            "  echo \"</tr>\";\n"
                        ],
                        [
                            336,
                            "}\n"
                        ],
                        [
                            337,
                            "?>\n"
                        ],
                        [
                            338,
                            "\n"
                        ],
                        [
                            339,
                            "</table>\n"
                        ],
                        [
                            340,
                            "\n"
                        ],
                        [
                            341,
                            "<!-- Clean up. -->\n"
                        ],
                        [
                            342,
                            "<?php\n"
                        ],
                        [
                            343,
                            "\n"
                        ],
                        [
                            344,
                            "  mysqli_free_result(\\$result);\n"
                        ],
                        [
                            345,
                            "  mysqli_close(\\$connection);\n"
                        ],
                        [
                            346,
                            "\n"
                        ],
                        [
                            347,
                            "?>\n"
                        ],
                        [
                            348,
                            "\n"
                        ],
                        [
                            349,
                            "</body>\n"
                        ],
                        [
                            350,
                            "</html>\n"
                        ],
                        [
                            351,
                            "\n"
                        ],
                        [
                            352,
                            "\n"
                        ],
                        [
                            353,
                            "<?php\n"
                        ],
                        [
                            354,
                            "\n"
                        ],
                        [
                            355,
                            "/* Add an employee to the table. */\n"
                        ],
                        [
                            356,
                            "function AddEmployee(\\$connection, \\$name, \\$address) {\n"
                        ],
                        [
                            357,
                            "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"
                        ],
                        [
                            358,
                            "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"
                        ],
                        [
                            359,
                            "\n"
                        ],
                        [
                            360,
                            "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"
                        ],
                        [
                            361,
                            "\n"
                        ],
                        [
                            362,
                            "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"
                        ],
                        [
                            363,
                            "}\n"
                        ],
                        [
                            364,
                            "\n"
                        ],
                        [
                            365,
                            "/* Check whether the table exists and, if not, create it. */\n"
                        ],
                        [
                            366,
                            "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"
                        ],
                        [
                            367,
                            "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"
                        ],
                        [
                            368,
                            "  {\n"
                        ],
                        [
                            369,
                            "     \\$query = \"CREATE TABLE EMPLOYEES (\n"
                        ],
                        [
                            370,
                            "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"
                        ],
                        [
                            371,
                            "         NAME VARCHAR(45),\n"
                        ],
                        [
                            372,
                            "         ADDRESS VARCHAR(90)\n"
                        ],
                        [
                            373,
                            "       )\";\n"
                        ],
                        [
                            374,
                            "\n"
                        ],
                        [
                            375,
                            "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"
                        ],
                        [
                            376,
                            "  }\n"
                        ],
                        [
                            377,
                            "}\n"
                        ],
                        [
                            378,
                            "\n"
                        ],
                        [
                            379,
                            "/* Check for the existence of a table. */\n"
                        ],
                        [
                            380,
                            "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"
                        ],
                        [
                            381,
                            "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"
                        ],
                        [
                            382,
                            "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"
                        ],
                        [
                            383,
                            "\n"
                        ],
                        [
                            384,
                            "  \\$checktable = mysqli_query(\\$connection,\n"
                        ],
                        [
                            385,
                            "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"
                        ],
                        [
                            386,
                            "\n"
                        ],
                        [
                            387,
                            "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"
                        ],
                        [
                            388,
                            "\n"
                        ],
                        [
                            389,
                            "  return false;\n"
                        ],
                        [
                            390,
                            "}\n"
                        ],
                        [
                            391,
                            "?>               \n"
                        ],
                        [
                            392,
                            "EnD\n"
                        ],
                        [
                            393,
                            "\n"
                        ],
                        [
                            394,
                            "sudo mv /tmp/index.php /var/www/html\n"
                        ],
                        [
                            395,
                            "sudo chown root:root /var/www/html/index.php\n"
                        ],
                        [
                            396,
                            "\n"
                        ],
                        [
                            397,
                            "\n"
                        ],
                        [
                            398,
                            "\n"
                        ],
                        [
                            399,
                            "EOF\n"
                        ],
                        [
                            400,
                            "  tags = merge({\n"
                        ],
                        [
                            401,
                            "    Name = \"${local.resource_prefix.value}-dbapp\"\n"
                        ],
                        [
                            402,
                            "    }, {\n"
                        ],
                        [
                            403,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            404,
                            "    git_file             = \"terraform/aws/db-app.tf\"\n"
                        ],
                        [
                            405,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            406,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            407,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            408,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            409,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            410,
                            "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"
                        ],
                        [
                            411,
                            "  })\n"
                        ],
                        [
                            412,
                            "}\n"
                        ]
                    ],
                    "file_path": "/db-app.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                    "repo_file_path": "/terragoat/terraform/aws/db-app.tf",
                    "file_line_range": [
                        242,
                        412
                    ],
                    "resource": "aws_instance.db_app",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.LaunchConfigurationEBSEncryption",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-dbapp",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/db-app.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "user_data": [
                            {
                                "type": "variable",
                                "name": "password",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "iam_instance_profile": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_iam_instance_profile.ec2profile",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/db-app.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_79",
                    "bc_check_id": null,
                    "check_name": "Ensure Instance Metadata Service Version 1 is not enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "metadata_options/[0]/http_tokens",
                            "metadata_options/[0]/http_endpoint"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_instance\" \"web_host\" {\n"
                        ],
                        [
                            2,
                            "  # ec2 have plain text secrets in user data\n"
                        ],
                        [
                            3,
                            "  ami           = \"${var.ami}\"\n"
                        ],
                        [
                            4,
                            "  instance_type = \"t2.nano\"\n"
                        ],
                        [
                            5,
                            "\n"
                        ],
                        [
                            6,
                            "  vpc_security_group_ids = [\n"
                        ],
                        [
                            7,
                            "  \"${aws_security_group.web-node.id}\"]\n"
                        ],
                        [
                            8,
                            "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"
                        ],
                        [
                            9,
                            "  user_data = <<EOF\n"
                        ],
                        [
                            10,
                            "#! /bin/bash\n"
                        ],
                        [
                            11,
                            "sudo apt-get update\n"
                        ],
                        [
                            12,
                            "sudo apt-get install -y apache2\n"
                        ],
                        [
                            13,
                            "sudo systemctl start apache2\n"
                        ],
                        [
                            14,
                            "sudo systemctl enable apache2\n"
                        ],
                        [
                            15,
                            "export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAA\n"
                        ],
                        [
                            16,
                            "export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMAAAKEY\n"
                        ],
                        [
                            17,
                            "export AWS_DEFAULT_REGION=us-west-2\n"
                        ],
                        [
                            18,
                            "echo \"<h1>Deployed via Terraform</h1>\" | sudo tee /var/www/html/index.html\n"
                        ],
                        [
                            19,
                            "EOF\n"
                        ],
                        [
                            20,
                            "  tags = merge({\n"
                        ],
                        [
                            21,
                            "    Name = \"${local.resource_prefix.value}-ec2\"\n"
                        ],
                        [
                            22,
                            "    }, {\n"
                        ],
                        [
                            23,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            24,
                            "    git_file             = \"terraform/aws/ec2.tf\"\n"
                        ],
                        [
                            25,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            26,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            27,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            28,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            29,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            30,
                            "    yor_trace            = \"347af3cd-4f70-4632-aca3-4d5e30ffc0b6\"\n"
                        ],
                        [
                            31,
                            "  })\n"
                        ],
                        [
                            32,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ec2.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ec2.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ec2.tf",
                    "file_line_range": [
                        1,
                        32
                    ],
                    "resource": "aws_instance.web_host",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.IMDSv1Disabled",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-ec2",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/ec2.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "347af3cd-4f70-4632-aca3-4d5e30ffc0b6"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "ami": [
                            {
                                "type": "variable",
                                "name": "ami",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_46",
                    "bc_check_id": null,
                    "check_name": "Ensure no hard-coded secrets exist in EC2 user data",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "user_data"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_instance\" \"web_host\" {\n"
                        ],
                        [
                            2,
                            "  # ec2 have plain text secrets in user data\n"
                        ],
                        [
                            3,
                            "  ami           = \"${var.ami}\"\n"
                        ],
                        [
                            4,
                            "  instance_type = \"t2.nano\"\n"
                        ],
                        [
                            5,
                            "\n"
                        ],
                        [
                            6,
                            "  vpc_security_group_ids = [\n"
                        ],
                        [
                            7,
                            "  \"${aws_security_group.web-node.id}\"]\n"
                        ],
                        [
                            8,
                            "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"
                        ],
                        [
                            9,
                            "  user_data = <<EOF\n"
                        ],
                        [
                            10,
                            "#! /bin/bash\n"
                        ],
                        [
                            11,
                            "sudo apt-get update\n"
                        ],
                        [
                            12,
                            "sudo apt-get install -y apache2\n"
                        ],
                        [
                            13,
                            "sudo systemctl start apache2\n"
                        ],
                        [
                            14,
                            "sudo systemctl enable apache2\n"
                        ],
                        [
                            15,
                            "export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAA\n"
                        ],
                        [
                            16,
                            "export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMAAAKEY\n"
                        ],
                        [
                            17,
                            "export AWS_DEFAULT_REGION=us-west-2\n"
                        ],
                        [
                            18,
                            "echo \"<h1>Deployed via Terraform</h1>\" | sudo tee /var/www/html/index.html\n"
                        ],
                        [
                            19,
                            "EOF\n"
                        ],
                        [
                            20,
                            "  tags = merge({\n"
                        ],
                        [
                            21,
                            "    Name = \"${local.resource_prefix.value}-ec2\"\n"
                        ],
                        [
                            22,
                            "    }, {\n"
                        ],
                        [
                            23,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            24,
                            "    git_file             = \"terraform/aws/ec2.tf\"\n"
                        ],
                        [
                            25,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            26,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            27,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            28,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            29,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            30,
                            "    yor_trace            = \"347af3cd-4f70-4632-aca3-4d5e30ffc0b6\"\n"
                        ],
                        [
                            31,
                            "  })\n"
                        ],
                        [
                            32,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ec2.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ec2.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ec2.tf",
                    "file_line_range": [
                        1,
                        32
                    ],
                    "resource": "aws_instance.web_host",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.EC2Credentials",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-ec2",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/ec2.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "347af3cd-4f70-4632-aca3-4d5e30ffc0b6"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "ami": [
                            {
                                "type": "variable",
                                "name": "ami",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_126",
                    "bc_check_id": null,
                    "check_name": "Ensure that detailed monitoring is enabled for EC2 instances",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "monitoring"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_instance\" \"web_host\" {\n"
                        ],
                        [
                            2,
                            "  # ec2 have plain text secrets in user data\n"
                        ],
                        [
                            3,
                            "  ami           = \"${var.ami}\"\n"
                        ],
                        [
                            4,
                            "  instance_type = \"t2.nano\"\n"
                        ],
                        [
                            5,
                            "\n"
                        ],
                        [
                            6,
                            "  vpc_security_group_ids = [\n"
                        ],
                        [
                            7,
                            "  \"${aws_security_group.web-node.id}\"]\n"
                        ],
                        [
                            8,
                            "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"
                        ],
                        [
                            9,
                            "  user_data = <<EOF\n"
                        ],
                        [
                            10,
                            "#! /bin/bash\n"
                        ],
                        [
                            11,
                            "sudo apt-get update\n"
                        ],
                        [
                            12,
                            "sudo apt-get install -y apache2\n"
                        ],
                        [
                            13,
                            "sudo systemctl start apache2\n"
                        ],
                        [
                            14,
                            "sudo systemctl enable apache2\n"
                        ],
                        [
                            15,
                            "export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAA\n"
                        ],
                        [
                            16,
                            "export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMAAAKEY\n"
                        ],
                        [
                            17,
                            "export AWS_DEFAULT_REGION=us-west-2\n"
                        ],
                        [
                            18,
                            "echo \"<h1>Deployed via Terraform</h1>\" | sudo tee /var/www/html/index.html\n"
                        ],
                        [
                            19,
                            "EOF\n"
                        ],
                        [
                            20,
                            "  tags = merge({\n"
                        ],
                        [
                            21,
                            "    Name = \"${local.resource_prefix.value}-ec2\"\n"
                        ],
                        [
                            22,
                            "    }, {\n"
                        ],
                        [
                            23,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            24,
                            "    git_file             = \"terraform/aws/ec2.tf\"\n"
                        ],
                        [
                            25,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            26,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            27,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            28,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            29,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            30,
                            "    yor_trace            = \"347af3cd-4f70-4632-aca3-4d5e30ffc0b6\"\n"
                        ],
                        [
                            31,
                            "  })\n"
                        ],
                        [
                            32,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ec2.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ec2.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ec2.tf",
                    "file_line_range": [
                        1,
                        32
                    ],
                    "resource": "aws_instance.web_host",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.EC2DetailedMonitoringEnabled",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-ec2",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/ec2.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "347af3cd-4f70-4632-aca3-4d5e30ffc0b6"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "ami": [
                            {
                                "type": "variable",
                                "name": "ami",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_135",
                    "bc_check_id": null,
                    "check_name": "Ensure that EC2 is EBS optimized",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "ebs_optimized"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_instance\" \"web_host\" {\n"
                        ],
                        [
                            2,
                            "  # ec2 have plain text secrets in user data\n"
                        ],
                        [
                            3,
                            "  ami           = \"${var.ami}\"\n"
                        ],
                        [
                            4,
                            "  instance_type = \"t2.nano\"\n"
                        ],
                        [
                            5,
                            "\n"
                        ],
                        [
                            6,
                            "  vpc_security_group_ids = [\n"
                        ],
                        [
                            7,
                            "  \"${aws_security_group.web-node.id}\"]\n"
                        ],
                        [
                            8,
                            "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"
                        ],
                        [
                            9,
                            "  user_data = <<EOF\n"
                        ],
                        [
                            10,
                            "#! /bin/bash\n"
                        ],
                        [
                            11,
                            "sudo apt-get update\n"
                        ],
                        [
                            12,
                            "sudo apt-get install -y apache2\n"
                        ],
                        [
                            13,
                            "sudo systemctl start apache2\n"
                        ],
                        [
                            14,
                            "sudo systemctl enable apache2\n"
                        ],
                        [
                            15,
                            "export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAA\n"
                        ],
                        [
                            16,
                            "export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMAAAKEY\n"
                        ],
                        [
                            17,
                            "export AWS_DEFAULT_REGION=us-west-2\n"
                        ],
                        [
                            18,
                            "echo \"<h1>Deployed via Terraform</h1>\" | sudo tee /var/www/html/index.html\n"
                        ],
                        [
                            19,
                            "EOF\n"
                        ],
                        [
                            20,
                            "  tags = merge({\n"
                        ],
                        [
                            21,
                            "    Name = \"${local.resource_prefix.value}-ec2\"\n"
                        ],
                        [
                            22,
                            "    }, {\n"
                        ],
                        [
                            23,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            24,
                            "    git_file             = \"terraform/aws/ec2.tf\"\n"
                        ],
                        [
                            25,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            26,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            27,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            28,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            29,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            30,
                            "    yor_trace            = \"347af3cd-4f70-4632-aca3-4d5e30ffc0b6\"\n"
                        ],
                        [
                            31,
                            "  })\n"
                        ],
                        [
                            32,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ec2.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ec2.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ec2.tf",
                    "file_line_range": [
                        1,
                        32
                    ],
                    "resource": "aws_instance.web_host",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.EC2EBSOptimized",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-ec2",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/ec2.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "347af3cd-4f70-4632-aca3-4d5e30ffc0b6"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "ami": [
                            {
                                "type": "variable",
                                "name": "ami",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_8",
                    "bc_check_id": null,
                    "check_name": "Ensure all data stored in the Launch configuration EBS is securely encrypted",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "*_block_device/[0]/encrypted"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_instance\" \"web_host\" {\n"
                        ],
                        [
                            2,
                            "  # ec2 have plain text secrets in user data\n"
                        ],
                        [
                            3,
                            "  ami           = \"${var.ami}\"\n"
                        ],
                        [
                            4,
                            "  instance_type = \"t2.nano\"\n"
                        ],
                        [
                            5,
                            "\n"
                        ],
                        [
                            6,
                            "  vpc_security_group_ids = [\n"
                        ],
                        [
                            7,
                            "  \"${aws_security_group.web-node.id}\"]\n"
                        ],
                        [
                            8,
                            "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"
                        ],
                        [
                            9,
                            "  user_data = <<EOF\n"
                        ],
                        [
                            10,
                            "#! /bin/bash\n"
                        ],
                        [
                            11,
                            "sudo apt-get update\n"
                        ],
                        [
                            12,
                            "sudo apt-get install -y apache2\n"
                        ],
                        [
                            13,
                            "sudo systemctl start apache2\n"
                        ],
                        [
                            14,
                            "sudo systemctl enable apache2\n"
                        ],
                        [
                            15,
                            "export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAA\n"
                        ],
                        [
                            16,
                            "export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMAAAKEY\n"
                        ],
                        [
                            17,
                            "export AWS_DEFAULT_REGION=us-west-2\n"
                        ],
                        [
                            18,
                            "echo \"<h1>Deployed via Terraform</h1>\" | sudo tee /var/www/html/index.html\n"
                        ],
                        [
                            19,
                            "EOF\n"
                        ],
                        [
                            20,
                            "  tags = merge({\n"
                        ],
                        [
                            21,
                            "    Name = \"${local.resource_prefix.value}-ec2\"\n"
                        ],
                        [
                            22,
                            "    }, {\n"
                        ],
                        [
                            23,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            24,
                            "    git_file             = \"terraform/aws/ec2.tf\"\n"
                        ],
                        [
                            25,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            26,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            27,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            28,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            29,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            30,
                            "    yor_trace            = \"347af3cd-4f70-4632-aca3-4d5e30ffc0b6\"\n"
                        ],
                        [
                            31,
                            "  })\n"
                        ],
                        [
                            32,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ec2.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ec2.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ec2.tf",
                    "file_line_range": [
                        1,
                        32
                    ],
                    "resource": "aws_instance.web_host",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.LaunchConfigurationEBSEncryption",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-ec2",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/ec2.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "347af3cd-4f70-4632-aca3-4d5e30ffc0b6"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "ami": [
                            {
                                "type": "variable",
                                "name": "ami",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_3",
                    "bc_check_id": null,
                    "check_name": "Ensure all data stored in the EBS is securely encrypted",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "encrypted"
                        ]
                    },
                    "code_block": [
                        [
                            34,
                            "resource \"aws_ebs_volume\" \"web_host_storage\" {\n"
                        ],
                        [
                            35,
                            "  # unencrypted volume\n"
                        ],
                        [
                            36,
                            "  availability_zone = \"${var.region}a\"\n"
                        ],
                        [
                            37,
                            "  #encrypted         = false  # Setting this causes the volume to be recreated on apply \n"
                        ],
                        [
                            38,
                            "  size = 1\n"
                        ],
                        [
                            39,
                            "  tags = merge({\n"
                        ],
                        [
                            40,
                            "    Name = \"${local.resource_prefix.value}-ebs\"\n"
                        ],
                        [
                            41,
                            "    }, {\n"
                        ],
                        [
                            42,
                            "    git_commit           = \"6e62522d2ab8f63740e53752b84a6e99cd65696a\"\n"
                        ],
                        [
                            43,
                            "    git_file             = \"terraform/aws/ec2.tf\"\n"
                        ],
                        [
                            44,
                            "    git_last_modified_at = \"2021-05-02 11:16:31\"\n"
                        ],
                        [
                            45,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            46,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            47,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            48,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            49,
                            "    yor_trace            = \"c5509daf-10f0-46af-9e03-41989212521d\"\n"
                        ],
                        [
                            50,
                            "  })\n"
                        ],
                        [
                            51,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ec2.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ec2.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ec2.tf",
                    "file_line_range": [
                        34,
                        51
                    ],
                    "resource": "aws_ebs_volume.web_host_storage",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.EBSEncryption",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-ebs",
                        "git_commit": "6e62522d2ab8f63740e53752b84a6e99cd65696a",
                        "git_file": "terraform/aws/ec2.tf",
                        "git_last_modified_at": "2021-05-0211:16:31",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "c5509daf-10f0-46af-9e03-41989212521d"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "availability_zone": [
                            {
                                "type": "variable",
                                "name": "region",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_24",
                    "bc_check_id": null,
                    "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "ingress/[1]/from_port",
                            "ingress/[1]/to_port",
                            "ingress/[1]/cidr_blocks",
                            "ingress/[1]/ipv6_cidr_blocks"
                        ]
                    },
                    "code_block": [
                        [
                            77,
                            "resource \"aws_security_group\" \"web-node\" {\n"
                        ],
                        [
                            78,
                            "  # security group is open to the world in SSH port\n"
                        ],
                        [
                            79,
                            "  name        = \"${local.resource_prefix.value}-sg\"\n"
                        ],
                        [
                            80,
                            "  description = \"${local.resource_prefix.value} Security Group\"\n"
                        ],
                        [
                            81,
                            "  vpc_id      = aws_vpc.web_vpc.id\n"
                        ],
                        [
                            82,
                            "\n"
                        ],
                        [
                            83,
                            "  ingress {\n"
                        ],
                        [
                            84,
                            "    from_port = 80\n"
                        ],
                        [
                            85,
                            "    to_port   = 80\n"
                        ],
                        [
                            86,
                            "    protocol  = \"tcp\"\n"
                        ],
                        [
                            87,
                            "    cidr_blocks = [\n"
                        ],
                        [
                            88,
                            "    \"0.0.0.0/0\"]\n"
                        ],
                        [
                            89,
                            "  }\n"
                        ],
                        [
                            90,
                            "  ingress {\n"
                        ],
                        [
                            91,
                            "    from_port = 22\n"
                        ],
                        [
                            92,
                            "    to_port   = 22\n"
                        ],
                        [
                            93,
                            "    protocol  = \"tcp\"\n"
                        ],
                        [
                            94,
                            "    cidr_blocks = [\n"
                        ],
                        [
                            95,
                            "    \"0.0.0.0/0\"]\n"
                        ],
                        [
                            96,
                            "  }\n"
                        ],
                        [
                            97,
                            "  egress {\n"
                        ],
                        [
                            98,
                            "    from_port = 0\n"
                        ],
                        [
                            99,
                            "    to_port   = 0\n"
                        ],
                        [
                            100,
                            "    protocol  = \"-1\"\n"
                        ],
                        [
                            101,
                            "    cidr_blocks = [\n"
                        ],
                        [
                            102,
                            "    \"0.0.0.0/0\"]\n"
                        ],
                        [
                            103,
                            "  }\n"
                        ],
                        [
                            104,
                            "  depends_on = [aws_vpc.web_vpc]\n"
                        ],
                        [
                            105,
                            "  tags = {\n"
                        ],
                        [
                            106,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            107,
                            "    git_file             = \"terraform/aws/ec2.tf\"\n"
                        ],
                        [
                            108,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            109,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            110,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            111,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            112,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            113,
                            "    yor_trace            = \"b7af1b40-64eb-4519-a1a0-ab198db4b193\"\n"
                        ],
                        [
                            114,
                            "  }\n"
                        ],
                        [
                            115,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ec2.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ec2.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ec2.tf",
                    "file_line_range": [
                        77,
                        115
                    ],
                    "resource": "aws_security_group.web-node",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/ec2.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "b7af1b40-64eb-4519-a1a0-ab198db4b193"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "description": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_23",
                    "bc_check_id": null,
                    "check_name": "Ensure every security groups rule has a description",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "description",
                            "egress/[0]",
                            "ingress/[0]"
                        ]
                    },
                    "code_block": [
                        [
                            77,
                            "resource \"aws_security_group\" \"web-node\" {\n"
                        ],
                        [
                            78,
                            "  # security group is open to the world in SSH port\n"
                        ],
                        [
                            79,
                            "  name        = \"${local.resource_prefix.value}-sg\"\n"
                        ],
                        [
                            80,
                            "  description = \"${local.resource_prefix.value} Security Group\"\n"
                        ],
                        [
                            81,
                            "  vpc_id      = aws_vpc.web_vpc.id\n"
                        ],
                        [
                            82,
                            "\n"
                        ],
                        [
                            83,
                            "  ingress {\n"
                        ],
                        [
                            84,
                            "    from_port = 80\n"
                        ],
                        [
                            85,
                            "    to_port   = 80\n"
                        ],
                        [
                            86,
                            "    protocol  = \"tcp\"\n"
                        ],
                        [
                            87,
                            "    cidr_blocks = [\n"
                        ],
                        [
                            88,
                            "    \"0.0.0.0/0\"]\n"
                        ],
                        [
                            89,
                            "  }\n"
                        ],
                        [
                            90,
                            "  ingress {\n"
                        ],
                        [
                            91,
                            "    from_port = 22\n"
                        ],
                        [
                            92,
                            "    to_port   = 22\n"
                        ],
                        [
                            93,
                            "    protocol  = \"tcp\"\n"
                        ],
                        [
                            94,
                            "    cidr_blocks = [\n"
                        ],
                        [
                            95,
                            "    \"0.0.0.0/0\"]\n"
                        ],
                        [
                            96,
                            "  }\n"
                        ],
                        [
                            97,
                            "  egress {\n"
                        ],
                        [
                            98,
                            "    from_port = 0\n"
                        ],
                        [
                            99,
                            "    to_port   = 0\n"
                        ],
                        [
                            100,
                            "    protocol  = \"-1\"\n"
                        ],
                        [
                            101,
                            "    cidr_blocks = [\n"
                        ],
                        [
                            102,
                            "    \"0.0.0.0/0\"]\n"
                        ],
                        [
                            103,
                            "  }\n"
                        ],
                        [
                            104,
                            "  depends_on = [aws_vpc.web_vpc]\n"
                        ],
                        [
                            105,
                            "  tags = {\n"
                        ],
                        [
                            106,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            107,
                            "    git_file             = \"terraform/aws/ec2.tf\"\n"
                        ],
                        [
                            108,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            109,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            110,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            111,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            112,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            113,
                            "    yor_trace            = \"b7af1b40-64eb-4519-a1a0-ab198db4b193\"\n"
                        ],
                        [
                            114,
                            "  }\n"
                        ],
                        [
                            115,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ec2.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ec2.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ec2.tf",
                    "file_line_range": [
                        77,
                        115
                    ],
                    "resource": "aws_security_group.web-node",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/ec2.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "b7af1b40-64eb-4519-a1a0-ab198db4b193"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "description": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_130",
                    "bc_check_id": null,
                    "check_name": "Ensure VPC subnets do not assign public IP by default",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "map_public_ip_on_launch"
                        ]
                    },
                    "code_block": [
                        [
                            135,
                            "resource \"aws_subnet\" \"web_subnet\" {\n"
                        ],
                        [
                            136,
                            "  vpc_id                  = aws_vpc.web_vpc.id\n"
                        ],
                        [
                            137,
                            "  cidr_block              = \"172.16.10.0/24\"\n"
                        ],
                        [
                            138,
                            "  availability_zone       = \"${var.region}a\"\n"
                        ],
                        [
                            139,
                            "  map_public_ip_on_launch = true\n"
                        ],
                        [
                            140,
                            "\n"
                        ],
                        [
                            141,
                            "  tags = merge({\n"
                        ],
                        [
                            142,
                            "    Name = \"${local.resource_prefix.value}-subnet\"\n"
                        ],
                        [
                            143,
                            "    }, {\n"
                        ],
                        [
                            144,
                            "    git_commit           = \"6e62522d2ab8f63740e53752b84a6e99cd65696a\"\n"
                        ],
                        [
                            145,
                            "    git_file             = \"terraform/aws/ec2.tf\"\n"
                        ],
                        [
                            146,
                            "    git_last_modified_at = \"2021-05-02 11:16:31\"\n"
                        ],
                        [
                            147,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            148,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            149,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            150,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            151,
                            "    yor_trace            = \"0345f650-d280-4ca8-86c9-c71c38c0eda8\"\n"
                        ],
                        [
                            152,
                            "  })\n"
                        ],
                        [
                            153,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ec2.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ec2.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ec2.tf",
                    "file_line_range": [
                        135,
                        153
                    ],
                    "resource": "aws_subnet.web_subnet",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-subnet",
                        "git_commit": "6e62522d2ab8f63740e53752b84a6e99cd65696a",
                        "git_file": "terraform/aws/ec2.tf",
                        "git_last_modified_at": "2021-05-0211:16:31",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "0345f650-d280-4ca8-86c9-c71c38c0eda8"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "availability_zone": [
                            {
                                "type": "variable",
                                "name": "region",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_130",
                    "bc_check_id": null,
                    "check_name": "Ensure VPC subnets do not assign public IP by default",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "map_public_ip_on_launch"
                        ]
                    },
                    "code_block": [
                        [
                            155,
                            "resource \"aws_subnet\" \"web_subnet2\" {\n"
                        ],
                        [
                            156,
                            "  vpc_id                  = aws_vpc.web_vpc.id\n"
                        ],
                        [
                            157,
                            "  cidr_block              = \"172.16.11.0/24\"\n"
                        ],
                        [
                            158,
                            "  availability_zone       = \"${var.region}b\"\n"
                        ],
                        [
                            159,
                            "  map_public_ip_on_launch = true\n"
                        ],
                        [
                            160,
                            "\n"
                        ],
                        [
                            161,
                            "  tags = merge({\n"
                        ],
                        [
                            162,
                            "    Name = \"${local.resource_prefix.value}-subnet2\"\n"
                        ],
                        [
                            163,
                            "    }, {\n"
                        ],
                        [
                            164,
                            "    git_commit           = \"6e62522d2ab8f63740e53752b84a6e99cd65696a\"\n"
                        ],
                        [
                            165,
                            "    git_file             = \"terraform/aws/ec2.tf\"\n"
                        ],
                        [
                            166,
                            "    git_last_modified_at = \"2021-05-02 11:16:31\"\n"
                        ],
                        [
                            167,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            168,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            169,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            170,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            171,
                            "    yor_trace            = \"224af03a-00e0-4981-be30-14965833c2db\"\n"
                        ],
                        [
                            172,
                            "  })\n"
                        ],
                        [
                            173,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ec2.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ec2.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ec2.tf",
                    "file_line_range": [
                        155,
                        173
                    ],
                    "resource": "aws_subnet.web_subnet2",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-subnet2",
                        "git_commit": "6e62522d2ab8f63740e53752b84a6e99cd65696a",
                        "git_file": "terraform/aws/ec2.tf",
                        "git_last_modified_at": "2021-05-0211:16:31",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "224af03a-00e0-4981-be30-14965833c2db"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "availability_zone": [
                            {
                                "type": "variable",
                                "name": "region",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_19",
                    "bc_check_id": null,
                    "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "server_side_encryption_configuration/[0]/rule/[0]/apply_server_side_encryption_by_default/[0]/sse_algorithm"
                        ]
                    },
                    "code_block": [
                        [
                            271,
                            "resource \"aws_s3_bucket\" \"flowbucket\" {\n"
                        ],
                        [
                            272,
                            "  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n"
                        ],
                        [
                            273,
                            "  force_destroy = true\n"
                        ],
                        [
                            274,
                            "\n"
                        ],
                        [
                            275,
                            "  tags = merge({\n"
                        ],
                        [
                            276,
                            "    Name        = \"${local.resource_prefix.value}-flowlogs\"\n"
                        ],
                        [
                            277,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            278,
                            "    }, {\n"
                        ],
                        [
                            279,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            280,
                            "    git_file             = \"terraform/aws/ec2.tf\"\n"
                        ],
                        [
                            281,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            282,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            283,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            284,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            285,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            286,
                            "    yor_trace            = \"f058838a-b1e0-4383-b965-7e06e987ffb1\"\n"
                        ],
                        [
                            287,
                            "  })\n"
                        ],
                        [
                            288,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ec2.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ec2.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ec2.tf",
                    "file_line_range": [
                        271,
                        288
                    ],
                    "resource": "aws_s3_bucket.flowbucket",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3Encryption",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/ec2.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_18",
                    "bc_check_id": null,
                    "check_name": "Ensure the S3 bucket has access logging enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "logging"
                        ]
                    },
                    "code_block": [
                        [
                            271,
                            "resource \"aws_s3_bucket\" \"flowbucket\" {\n"
                        ],
                        [
                            272,
                            "  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n"
                        ],
                        [
                            273,
                            "  force_destroy = true\n"
                        ],
                        [
                            274,
                            "\n"
                        ],
                        [
                            275,
                            "  tags = merge({\n"
                        ],
                        [
                            276,
                            "    Name        = \"${local.resource_prefix.value}-flowlogs\"\n"
                        ],
                        [
                            277,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            278,
                            "    }, {\n"
                        ],
                        [
                            279,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            280,
                            "    git_file             = \"terraform/aws/ec2.tf\"\n"
                        ],
                        [
                            281,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            282,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            283,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            284,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            285,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            286,
                            "    yor_trace            = \"f058838a-b1e0-4383-b965-7e06e987ffb1\"\n"
                        ],
                        [
                            287,
                            "  })\n"
                        ],
                        [
                            288,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ec2.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ec2.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ec2.tf",
                    "file_line_range": [
                        271,
                        288
                    ],
                    "resource": "aws_s3_bucket.flowbucket",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3AccessLogs",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/ec2.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_144",
                    "bc_check_id": null,
                    "check_name": "Ensure that S3 bucket has cross-region replication enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "replication_configuration/[0]/role"
                        ]
                    },
                    "code_block": [
                        [
                            271,
                            "resource \"aws_s3_bucket\" \"flowbucket\" {\n"
                        ],
                        [
                            272,
                            "  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n"
                        ],
                        [
                            273,
                            "  force_destroy = true\n"
                        ],
                        [
                            274,
                            "\n"
                        ],
                        [
                            275,
                            "  tags = merge({\n"
                        ],
                        [
                            276,
                            "    Name        = \"${local.resource_prefix.value}-flowlogs\"\n"
                        ],
                        [
                            277,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            278,
                            "    }, {\n"
                        ],
                        [
                            279,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            280,
                            "    git_file             = \"terraform/aws/ec2.tf\"\n"
                        ],
                        [
                            281,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            282,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            283,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            284,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            285,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            286,
                            "    yor_trace            = \"f058838a-b1e0-4383-b965-7e06e987ffb1\"\n"
                        ],
                        [
                            287,
                            "  })\n"
                        ],
                        [
                            288,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ec2.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ec2.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ec2.tf",
                    "file_line_range": [
                        271,
                        288
                    ],
                    "resource": "aws_s3_bucket.flowbucket",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3BucketReplicationConfiguration",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/ec2.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_145",
                    "bc_check_id": null,
                    "check_name": "Ensure that S3 buckets are encrypted with KMS by default",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "server_side_encryption_configuration/[0]/rule/[0]/apply_server_side_encryption_by_default/[0]/sse_algorithm"
                        ]
                    },
                    "code_block": [
                        [
                            271,
                            "resource \"aws_s3_bucket\" \"flowbucket\" {\n"
                        ],
                        [
                            272,
                            "  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n"
                        ],
                        [
                            273,
                            "  force_destroy = true\n"
                        ],
                        [
                            274,
                            "\n"
                        ],
                        [
                            275,
                            "  tags = merge({\n"
                        ],
                        [
                            276,
                            "    Name        = \"${local.resource_prefix.value}-flowlogs\"\n"
                        ],
                        [
                            277,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            278,
                            "    }, {\n"
                        ],
                        [
                            279,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            280,
                            "    git_file             = \"terraform/aws/ec2.tf\"\n"
                        ],
                        [
                            281,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            282,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            283,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            284,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            285,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            286,
                            "    yor_trace            = \"f058838a-b1e0-4383-b965-7e06e987ffb1\"\n"
                        ],
                        [
                            287,
                            "  })\n"
                        ],
                        [
                            288,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ec2.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ec2.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ec2.tf",
                    "file_line_range": [
                        271,
                        288
                    ],
                    "resource": "aws_s3_bucket.flowbucket",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3KMSEncryptedByDefault",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/ec2.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_21",
                    "bc_check_id": null,
                    "check_name": "Ensure all data stored in the S3 bucket have versioning enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "versioning/[0]/enabled"
                        ]
                    },
                    "code_block": [
                        [
                            271,
                            "resource \"aws_s3_bucket\" \"flowbucket\" {\n"
                        ],
                        [
                            272,
                            "  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n"
                        ],
                        [
                            273,
                            "  force_destroy = true\n"
                        ],
                        [
                            274,
                            "\n"
                        ],
                        [
                            275,
                            "  tags = merge({\n"
                        ],
                        [
                            276,
                            "    Name        = \"${local.resource_prefix.value}-flowlogs\"\n"
                        ],
                        [
                            277,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            278,
                            "    }, {\n"
                        ],
                        [
                            279,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            280,
                            "    git_file             = \"terraform/aws/ec2.tf\"\n"
                        ],
                        [
                            281,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            282,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            283,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            284,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            285,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            286,
                            "    yor_trace            = \"f058838a-b1e0-4383-b965-7e06e987ffb1\"\n"
                        ],
                        [
                            287,
                            "  })\n"
                        ],
                        [
                            288,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ec2.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ec2.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ec2.tf",
                    "file_line_range": [
                        271,
                        288
                    ],
                    "resource": "aws_s3_bucket.flowbucket",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3Versioning",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/ec2.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_163",
                    "bc_check_id": null,
                    "check_name": "Ensure ECR image scanning on push is enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "image_scanning_configuration/[0]/scan_on_push"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource aws_ecr_repository \"repository\" {\n"
                        ],
                        [
                            2,
                            "  name                 = \"${local.resource_prefix.value}-repository\"\n"
                        ],
                        [
                            3,
                            "  image_tag_mutability = \"MUTABLE\"\n"
                        ],
                        [
                            4,
                            "\n"
                        ],
                        [
                            5,
                            "  tags = merge({\n"
                        ],
                        [
                            6,
                            "    Name = \"${local.resource_prefix.value}-repository\"\n"
                        ],
                        [
                            7,
                            "    }, {\n"
                        ],
                        [
                            8,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            9,
                            "    git_file             = \"terraform/aws/ecr.tf\"\n"
                        ],
                        [
                            10,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            11,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            12,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            13,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            14,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            15,
                            "    yor_trace            = \"7a3ec657-fa54-4aa2-8467-5d08d6c90bc2\"\n"
                        ],
                        [
                            16,
                            "  })\n"
                        ],
                        [
                            17,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ecr.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ecr.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ecr.tf",
                    "file_line_range": [
                        1,
                        17
                    ],
                    "resource": "aws_ecr_repository.repository",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.ECRImageScanning",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-repository",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/ecr.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "7a3ec657-fa54-4aa2-8467-5d08d6c90bc2"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_ecr_repository.repository",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ecr.tf",
                                "module_connection": false
                            },
                            {
                                "type": "locals",
                                "name": "docker_image",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ecr.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_136",
                    "bc_check_id": null,
                    "check_name": "Ensure that ECR repositories are encrypted using KMS",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "encryption_configuration/[0]/encryption_type"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource aws_ecr_repository \"repository\" {\n"
                        ],
                        [
                            2,
                            "  name                 = \"${local.resource_prefix.value}-repository\"\n"
                        ],
                        [
                            3,
                            "  image_tag_mutability = \"MUTABLE\"\n"
                        ],
                        [
                            4,
                            "\n"
                        ],
                        [
                            5,
                            "  tags = merge({\n"
                        ],
                        [
                            6,
                            "    Name = \"${local.resource_prefix.value}-repository\"\n"
                        ],
                        [
                            7,
                            "    }, {\n"
                        ],
                        [
                            8,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            9,
                            "    git_file             = \"terraform/aws/ecr.tf\"\n"
                        ],
                        [
                            10,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            11,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            12,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            13,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            14,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            15,
                            "    yor_trace            = \"7a3ec657-fa54-4aa2-8467-5d08d6c90bc2\"\n"
                        ],
                        [
                            16,
                            "  })\n"
                        ],
                        [
                            17,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ecr.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ecr.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ecr.tf",
                    "file_line_range": [
                        1,
                        17
                    ],
                    "resource": "aws_ecr_repository.repository",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.ECRRepositoryEncrypted",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-repository",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/ecr.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "7a3ec657-fa54-4aa2-8467-5d08d6c90bc2"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_ecr_repository.repository",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ecr.tf",
                                "module_connection": false
                            },
                            {
                                "type": "locals",
                                "name": "docker_image",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ecr.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_51",
                    "bc_check_id": null,
                    "check_name": "Ensure ECR Image Tags are immutable",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "image_tag_mutability"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource aws_ecr_repository \"repository\" {\n"
                        ],
                        [
                            2,
                            "  name                 = \"${local.resource_prefix.value}-repository\"\n"
                        ],
                        [
                            3,
                            "  image_tag_mutability = \"MUTABLE\"\n"
                        ],
                        [
                            4,
                            "\n"
                        ],
                        [
                            5,
                            "  tags = merge({\n"
                        ],
                        [
                            6,
                            "    Name = \"${local.resource_prefix.value}-repository\"\n"
                        ],
                        [
                            7,
                            "    }, {\n"
                        ],
                        [
                            8,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            9,
                            "    git_file             = \"terraform/aws/ecr.tf\"\n"
                        ],
                        [
                            10,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            11,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            12,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            13,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            14,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            15,
                            "    yor_trace            = \"7a3ec657-fa54-4aa2-8467-5d08d6c90bc2\"\n"
                        ],
                        [
                            16,
                            "  })\n"
                        ],
                        [
                            17,
                            "}\n"
                        ]
                    ],
                    "file_path": "/ecr.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ecr.tf",
                    "repo_file_path": "/terragoat/terraform/aws/ecr.tf",
                    "file_line_range": [
                        1,
                        17
                    ],
                    "resource": "aws_ecr_repository.repository",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.ECRImmutableTags",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-repository",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/ecr.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "7a3ec657-fa54-4aa2-8467-5d08d6c90bc2"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_ecr_repository.repository",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ecr.tf",
                                "module_connection": false
                            },
                            {
                                "type": "locals",
                                "name": "docker_image",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/ecr.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_130",
                    "bc_check_id": null,
                    "check_name": "Ensure VPC subnets do not assign public IP by default",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "map_public_ip_on_launch"
                        ]
                    },
                    "code_block": [
                        [
                            61,
                            "resource aws_subnet \"eks_subnet1\" {\n"
                        ],
                        [
                            62,
                            "  vpc_id                  = aws_vpc.eks_vpc.id\n"
                        ],
                        [
                            63,
                            "  cidr_block              = \"10.10.10.0/24\"\n"
                        ],
                        [
                            64,
                            "  availability_zone       = \"${var.region}a\"\n"
                        ],
                        [
                            65,
                            "  map_public_ip_on_launch = true\n"
                        ],
                        [
                            66,
                            "  tags = merge({\n"
                        ],
                        [
                            67,
                            "    Name                                            = \"${local.resource_prefix.value}-eks-subnet\"\n"
                        ],
                        [
                            68,
                            "    \"kubernetes.io/cluster/${local.eks_name.value}\" = \"shared\"\n"
                        ],
                        [
                            69,
                            "    }, {\n"
                        ],
                        [
                            70,
                            "    git_commit                                       = \"6e62522d2ab8f63740e53752b84a6e99cd65696a\"\n"
                        ],
                        [
                            71,
                            "    git_file                                         = \"terraform/aws/eks.tf\"\n"
                        ],
                        [
                            72,
                            "    git_last_modified_at                             = \"2021-05-02 11:16:31\"\n"
                        ],
                        [
                            73,
                            "    git_last_modified_by                             = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            74,
                            "    git_modifiers                                    = \"nimrodkor\"\n"
                        ],
                        [
                            75,
                            "    git_org                                          = \"bridgecrewio\"\n"
                        ],
                        [
                            76,
                            "    git_repo                                         = \"terragoat\"\n"
                        ],
                        [
                            77,
                            "    \"kubernetes.io/cluster/$${local.eks_name.value}\" = \"shared\"\n"
                        ],
                        [
                            78,
                            "    yor_trace                                        = \"1fb4fa23-a5d6-4d6a-b7dc-88749383f48d\"\n"
                        ],
                        [
                            79,
                            "    }, {\n"
                        ],
                        [
                            80,
                            "    \"kubernetes.io/cluster/$$${local.eks_name.value}\" = \"shared\"\n"
                        ],
                        [
                            81,
                            "    \"kubernetes.io/cluster/$${local.eks_name.value}\"  = \"shared\"\n"
                        ],
                        [
                            82,
                            "    }, {\n"
                        ],
                        [
                            83,
                            "    \"kubernetes.io/cluster/$$$${local.eks_name.value}\" = \"shared\"\n"
                        ],
                        [
                            84,
                            "    \"kubernetes.io/cluster/$$${local.eks_name.value}\"  = \"shared\"\n"
                        ],
                        [
                            85,
                            "    \"kubernetes.io/cluster/$${local.eks_name.value}\"   = \"shared\"\n"
                        ],
                        [
                            86,
                            "  })\n"
                        ],
                        [
                            87,
                            "}\n"
                        ]
                    ],
                    "file_path": "/eks.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/eks.tf",
                    "repo_file_path": "/terragoat/terraform/aws/eks.tf",
                    "file_line_range": [
                        61,
                        87
                    ],
                    "resource": "aws_subnet.eks_subnet1",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-eks-subnet",
                        "kubernetes.io/cluster/data.aws_caller_identity.current.account_id-acme-dev-eks": "shared",
                        "git_commit": "6e62522d2ab8f63740e53752b84a6e99cd65696a",
                        "git_file": "terraform/aws/eks.tf",
                        "git_last_modified_at": "2021-05-0211:16:31",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "kubernetes.io/cluster/$data.aws_caller_identity.current.account_id-acme-dev-eks": "shared",
                        "yor_trace": "1fb4fa23-a5d6-4d6a-b7dc-88749383f48d",
                        "kubernetes.io/cluster/$$data.aws_caller_identity.current.account_id-acme-dev-eks": "shared",
                        "kubernetes.io/cluster/$$$data.aws_caller_identity.current.account_id-acme-dev-eks": "shared"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "availability_zone": [
                            {
                                "type": "variable",
                                "name": "region",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "eks_name",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/eks.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_130",
                    "bc_check_id": null,
                    "check_name": "Ensure VPC subnets do not assign public IP by default",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "map_public_ip_on_launch"
                        ]
                    },
                    "code_block": [
                        [
                            89,
                            "resource aws_subnet \"eks_subnet2\" {\n"
                        ],
                        [
                            90,
                            "  vpc_id                  = aws_vpc.eks_vpc.id\n"
                        ],
                        [
                            91,
                            "  cidr_block              = \"10.10.11.0/24\"\n"
                        ],
                        [
                            92,
                            "  availability_zone       = \"${var.region}b\"\n"
                        ],
                        [
                            93,
                            "  map_public_ip_on_launch = true\n"
                        ],
                        [
                            94,
                            "  tags = merge({\n"
                        ],
                        [
                            95,
                            "    Name                                            = \"${local.resource_prefix.value}-eks-subnet2\"\n"
                        ],
                        [
                            96,
                            "    \"kubernetes.io/cluster/${local.eks_name.value}\" = \"shared\"\n"
                        ],
                        [
                            97,
                            "    }, {\n"
                        ],
                        [
                            98,
                            "    git_commit                                       = \"6e62522d2ab8f63740e53752b84a6e99cd65696a\"\n"
                        ],
                        [
                            99,
                            "    git_file                                         = \"terraform/aws/eks.tf\"\n"
                        ],
                        [
                            100,
                            "    git_last_modified_at                             = \"2021-05-02 11:16:31\"\n"
                        ],
                        [
                            101,
                            "    git_last_modified_by                             = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            102,
                            "    git_modifiers                                    = \"nimrodkor\"\n"
                        ],
                        [
                            103,
                            "    git_org                                          = \"bridgecrewio\"\n"
                        ],
                        [
                            104,
                            "    git_repo                                         = \"terragoat\"\n"
                        ],
                        [
                            105,
                            "    \"kubernetes.io/cluster/$${local.eks_name.value}\" = \"shared\"\n"
                        ],
                        [
                            106,
                            "    yor_trace                                        = \"9ce04af2-5321-4e6c-a262-e4d7c1f69525\"\n"
                        ],
                        [
                            107,
                            "    }, {\n"
                        ],
                        [
                            108,
                            "    \"kubernetes.io/cluster/$$${local.eks_name.value}\" = \"shared\"\n"
                        ],
                        [
                            109,
                            "    \"kubernetes.io/cluster/$${local.eks_name.value}\"  = \"shared\"\n"
                        ],
                        [
                            110,
                            "    }, {\n"
                        ],
                        [
                            111,
                            "    \"kubernetes.io/cluster/$$$${local.eks_name.value}\" = \"shared\"\n"
                        ],
                        [
                            112,
                            "    \"kubernetes.io/cluster/$$${local.eks_name.value}\"  = \"shared\"\n"
                        ],
                        [
                            113,
                            "    \"kubernetes.io/cluster/$${local.eks_name.value}\"   = \"shared\"\n"
                        ],
                        [
                            114,
                            "  })\n"
                        ],
                        [
                            115,
                            "}\n"
                        ]
                    ],
                    "file_path": "/eks.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/eks.tf",
                    "repo_file_path": "/terragoat/terraform/aws/eks.tf",
                    "file_line_range": [
                        89,
                        115
                    ],
                    "resource": "aws_subnet.eks_subnet2",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-eks-subnet2",
                        "kubernetes.io/cluster/data.aws_caller_identity.current.account_id-acme-dev-eks": "shared",
                        "git_commit": "6e62522d2ab8f63740e53752b84a6e99cd65696a",
                        "git_file": "terraform/aws/eks.tf",
                        "git_last_modified_at": "2021-05-0211:16:31",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "kubernetes.io/cluster/$data.aws_caller_identity.current.account_id-acme-dev-eks": "shared",
                        "yor_trace": "9ce04af2-5321-4e6c-a262-e4d7c1f69525",
                        "kubernetes.io/cluster/$$data.aws_caller_identity.current.account_id-acme-dev-eks": "shared",
                        "kubernetes.io/cluster/$$$data.aws_caller_identity.current.account_id-acme-dev-eks": "shared"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "availability_zone": [
                            {
                                "type": "variable",
                                "name": "region",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "eks_name",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/eks.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_39",
                    "bc_check_id": null,
                    "check_name": "Ensure Amazon EKS public endpoint disabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "vpc_config/[0]/endpoint_public_access"
                        ]
                    },
                    "code_block": [
                        [
                            117,
                            "resource aws_eks_cluster \"eks_cluster\" {\n"
                        ],
                        [
                            118,
                            "  name     = local.eks_name.value\n"
                        ],
                        [
                            119,
                            "  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"\n"
                        ],
                        [
                            120,
                            "\n"
                        ],
                        [
                            121,
                            "  vpc_config {\n"
                        ],
                        [
                            122,
                            "    endpoint_private_access = true\n"
                        ],
                        [
                            123,
                            "    subnet_ids              = [\"${aws_subnet.eks_subnet1.id}\", \"${aws_subnet.eks_subnet2.id}\"]\n"
                        ],
                        [
                            124,
                            "  }\n"
                        ],
                        [
                            125,
                            "\n"
                        ],
                        [
                            126,
                            "  depends_on = [\n"
                        ],
                        [
                            127,
                            "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSClusterPolicy\",\n"
                        ],
                        [
                            128,
                            "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSServicePolicy\",\n"
                        ],
                        [
                            129,
                            "  ]\n"
                        ],
                        [
                            130,
                            "  tags = {\n"
                        ],
                        [
                            131,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            132,
                            "    git_file             = \"terraform/aws/eks.tf\"\n"
                        ],
                        [
                            133,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            134,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            135,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            136,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            137,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            138,
                            "    yor_trace            = \"7fa14261-c18d-4fa2-aec4-746f6e64d2d3\"\n"
                        ],
                        [
                            139,
                            "  }\n"
                        ],
                        [
                            140,
                            "}\n"
                        ]
                    ],
                    "file_path": "/eks.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/eks.tf",
                    "repo_file_path": "/terragoat/terraform/aws/eks.tf",
                    "file_line_range": [
                        117,
                        140
                    ],
                    "resource": "aws_eks_cluster.eks_cluster",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.EKSPublicAccess",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/eks.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "7fa14261-c18d-4fa2-aec4-746f6e64d2d3"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "name": [
                            {
                                "type": "locals",
                                "name": "eks_name",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/eks.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_58",
                    "bc_check_id": null,
                    "check_name": "Ensure EKS Cluster has Secrets Encryption Enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "encryption_config/[0]/resources"
                        ]
                    },
                    "code_block": [
                        [
                            117,
                            "resource aws_eks_cluster \"eks_cluster\" {\n"
                        ],
                        [
                            118,
                            "  name     = local.eks_name.value\n"
                        ],
                        [
                            119,
                            "  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"\n"
                        ],
                        [
                            120,
                            "\n"
                        ],
                        [
                            121,
                            "  vpc_config {\n"
                        ],
                        [
                            122,
                            "    endpoint_private_access = true\n"
                        ],
                        [
                            123,
                            "    subnet_ids              = [\"${aws_subnet.eks_subnet1.id}\", \"${aws_subnet.eks_subnet2.id}\"]\n"
                        ],
                        [
                            124,
                            "  }\n"
                        ],
                        [
                            125,
                            "\n"
                        ],
                        [
                            126,
                            "  depends_on = [\n"
                        ],
                        [
                            127,
                            "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSClusterPolicy\",\n"
                        ],
                        [
                            128,
                            "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSServicePolicy\",\n"
                        ],
                        [
                            129,
                            "  ]\n"
                        ],
                        [
                            130,
                            "  tags = {\n"
                        ],
                        [
                            131,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            132,
                            "    git_file             = \"terraform/aws/eks.tf\"\n"
                        ],
                        [
                            133,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            134,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            135,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            136,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            137,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            138,
                            "    yor_trace            = \"7fa14261-c18d-4fa2-aec4-746f6e64d2d3\"\n"
                        ],
                        [
                            139,
                            "  }\n"
                        ],
                        [
                            140,
                            "}\n"
                        ]
                    ],
                    "file_path": "/eks.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/eks.tf",
                    "repo_file_path": "/terragoat/terraform/aws/eks.tf",
                    "file_line_range": [
                        117,
                        140
                    ],
                    "resource": "aws_eks_cluster.eks_cluster",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.EKSSecretsEncryption",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/eks.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "7fa14261-c18d-4fa2-aec4-746f6e64d2d3"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "name": [
                            {
                                "type": "locals",
                                "name": "eks_name",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/eks.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_38",
                    "bc_check_id": null,
                    "check_name": "Ensure Amazon EKS public endpoint not accessible to 0.0.0.0/0",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "vpc_config"
                        ]
                    },
                    "code_block": [
                        [
                            117,
                            "resource aws_eks_cluster \"eks_cluster\" {\n"
                        ],
                        [
                            118,
                            "  name     = local.eks_name.value\n"
                        ],
                        [
                            119,
                            "  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"\n"
                        ],
                        [
                            120,
                            "\n"
                        ],
                        [
                            121,
                            "  vpc_config {\n"
                        ],
                        [
                            122,
                            "    endpoint_private_access = true\n"
                        ],
                        [
                            123,
                            "    subnet_ids              = [\"${aws_subnet.eks_subnet1.id}\", \"${aws_subnet.eks_subnet2.id}\"]\n"
                        ],
                        [
                            124,
                            "  }\n"
                        ],
                        [
                            125,
                            "\n"
                        ],
                        [
                            126,
                            "  depends_on = [\n"
                        ],
                        [
                            127,
                            "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSClusterPolicy\",\n"
                        ],
                        [
                            128,
                            "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSServicePolicy\",\n"
                        ],
                        [
                            129,
                            "  ]\n"
                        ],
                        [
                            130,
                            "  tags = {\n"
                        ],
                        [
                            131,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            132,
                            "    git_file             = \"terraform/aws/eks.tf\"\n"
                        ],
                        [
                            133,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            134,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            135,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            136,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            137,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            138,
                            "    yor_trace            = \"7fa14261-c18d-4fa2-aec4-746f6e64d2d3\"\n"
                        ],
                        [
                            139,
                            "  }\n"
                        ],
                        [
                            140,
                            "}\n"
                        ]
                    ],
                    "file_path": "/eks.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/eks.tf",
                    "repo_file_path": "/terragoat/terraform/aws/eks.tf",
                    "file_line_range": [
                        117,
                        140
                    ],
                    "resource": "aws_eks_cluster.eks_cluster",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.EKSPublicAccessCIDR",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/eks.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "7fa14261-c18d-4fa2-aec4-746f6e64d2d3"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "name": [
                            {
                                "type": "locals",
                                "name": "eks_name",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/eks.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_37",
                    "bc_check_id": null,
                    "check_name": "Ensure Amazon EKS control plane logging enabled for all log types",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "enabled_cluster_log_types"
                        ]
                    },
                    "code_block": [
                        [
                            117,
                            "resource aws_eks_cluster \"eks_cluster\" {\n"
                        ],
                        [
                            118,
                            "  name     = local.eks_name.value\n"
                        ],
                        [
                            119,
                            "  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"\n"
                        ],
                        [
                            120,
                            "\n"
                        ],
                        [
                            121,
                            "  vpc_config {\n"
                        ],
                        [
                            122,
                            "    endpoint_private_access = true\n"
                        ],
                        [
                            123,
                            "    subnet_ids              = [\"${aws_subnet.eks_subnet1.id}\", \"${aws_subnet.eks_subnet2.id}\"]\n"
                        ],
                        [
                            124,
                            "  }\n"
                        ],
                        [
                            125,
                            "\n"
                        ],
                        [
                            126,
                            "  depends_on = [\n"
                        ],
                        [
                            127,
                            "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSClusterPolicy\",\n"
                        ],
                        [
                            128,
                            "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSServicePolicy\",\n"
                        ],
                        [
                            129,
                            "  ]\n"
                        ],
                        [
                            130,
                            "  tags = {\n"
                        ],
                        [
                            131,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            132,
                            "    git_file             = \"terraform/aws/eks.tf\"\n"
                        ],
                        [
                            133,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            134,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            135,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            136,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            137,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            138,
                            "    yor_trace            = \"7fa14261-c18d-4fa2-aec4-746f6e64d2d3\"\n"
                        ],
                        [
                            139,
                            "  }\n"
                        ],
                        [
                            140,
                            "}\n"
                        ]
                    ],
                    "file_path": "/eks.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/eks.tf",
                    "repo_file_path": "/terragoat/terraform/aws/eks.tf",
                    "file_line_range": [
                        117,
                        140
                    ],
                    "resource": "aws_eks_cluster.eks_cluster",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.EKSControlPlaneLogging",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/eks.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "7fa14261-c18d-4fa2-aec4-746f6e64d2d3"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "name": [
                            {
                                "type": "locals",
                                "name": "eks_name",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/eks.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_127",
                    "bc_check_id": null,
                    "check_name": "Ensure that Elastic Load Balancer(s) uses SSL certificates provided by AWS Certificate Manager",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "listener/0"
                        ]
                    },
                    "code_block": [
                        [
                            2,
                            "resource \"aws_elb\" \"weblb\" {\n"
                        ],
                        [
                            3,
                            "  name = \"weblb-terraform-elb\"\n"
                        ],
                        [
                            4,
                            "\n"
                        ],
                        [
                            5,
                            "  listener {\n"
                        ],
                        [
                            6,
                            "    instance_port     = 8000\n"
                        ],
                        [
                            7,
                            "    instance_protocol = \"http\"\n"
                        ],
                        [
                            8,
                            "    lb_port           = 80\n"
                        ],
                        [
                            9,
                            "    lb_protocol       = \"http\"\n"
                        ],
                        [
                            10,
                            "  }\n"
                        ],
                        [
                            11,
                            "\n"
                        ],
                        [
                            12,
                            "  health_check {\n"
                        ],
                        [
                            13,
                            "    healthy_threshold   = 2\n"
                        ],
                        [
                            14,
                            "    unhealthy_threshold = 2\n"
                        ],
                        [
                            15,
                            "    timeout             = 3\n"
                        ],
                        [
                            16,
                            "    target              = \"HTTP:8000/\"\n"
                        ],
                        [
                            17,
                            "    interval            = 30\n"
                        ],
                        [
                            18,
                            "  }\n"
                        ],
                        [
                            19,
                            "\n"
                        ],
                        [
                            20,
                            "  subnets                     = [aws_subnet.web_subnet.id]\n"
                        ],
                        [
                            21,
                            "  security_groups             = [aws_security_group.web-node.id]\n"
                        ],
                        [
                            22,
                            "  instances                   = [aws_instance.web_host.id]\n"
                        ],
                        [
                            23,
                            "  cross_zone_load_balancing   = true\n"
                        ],
                        [
                            24,
                            "  idle_timeout                = 400\n"
                        ],
                        [
                            25,
                            "  connection_draining         = true\n"
                        ],
                        [
                            26,
                            "  connection_draining_timeout = 400\n"
                        ],
                        [
                            27,
                            "\n"
                        ],
                        [
                            28,
                            "  tags = merge({\n"
                        ],
                        [
                            29,
                            "    Name = \"foobar-terraform-elb\"\n"
                        ],
                        [
                            30,
                            "    }, {\n"
                        ],
                        [
                            31,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            32,
                            "    git_file             = \"terraform/aws/elb.tf\"\n"
                        ],
                        [
                            33,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            34,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            35,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            36,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            37,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            38,
                            "    yor_trace            = \"b4a83ce9-9a45-43b4-b6d9-1783c282f702\"\n"
                        ],
                        [
                            39,
                            "  })\n"
                        ],
                        [
                            40,
                            "}"
                        ]
                    ],
                    "file_path": "/elb.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/elb.tf",
                    "repo_file_path": "/terragoat/terraform/aws/elb.tf",
                    "file_line_range": [
                        2,
                        40
                    ],
                    "resource": "aws_elb.weblb",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.ELBUsesSSL",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "foobar-terraform-elb",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/elb.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "b4a83ce9-9a45-43b4-b6d9-1783c282f702"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null
                },
                {
                    "check_id": "CKV_AWS_92",
                    "bc_check_id": null,
                    "check_name": "Ensure the ELB has access logging enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            2,
                            "resource \"aws_elb\" \"weblb\" {\n"
                        ],
                        [
                            3,
                            "  name = \"weblb-terraform-elb\"\n"
                        ],
                        [
                            4,
                            "\n"
                        ],
                        [
                            5,
                            "  listener {\n"
                        ],
                        [
                            6,
                            "    instance_port     = 8000\n"
                        ],
                        [
                            7,
                            "    instance_protocol = \"http\"\n"
                        ],
                        [
                            8,
                            "    lb_port           = 80\n"
                        ],
                        [
                            9,
                            "    lb_protocol       = \"http\"\n"
                        ],
                        [
                            10,
                            "  }\n"
                        ],
                        [
                            11,
                            "\n"
                        ],
                        [
                            12,
                            "  health_check {\n"
                        ],
                        [
                            13,
                            "    healthy_threshold   = 2\n"
                        ],
                        [
                            14,
                            "    unhealthy_threshold = 2\n"
                        ],
                        [
                            15,
                            "    timeout             = 3\n"
                        ],
                        [
                            16,
                            "    target              = \"HTTP:8000/\"\n"
                        ],
                        [
                            17,
                            "    interval            = 30\n"
                        ],
                        [
                            18,
                            "  }\n"
                        ],
                        [
                            19,
                            "\n"
                        ],
                        [
                            20,
                            "  subnets                     = [aws_subnet.web_subnet.id]\n"
                        ],
                        [
                            21,
                            "  security_groups             = [aws_security_group.web-node.id]\n"
                        ],
                        [
                            22,
                            "  instances                   = [aws_instance.web_host.id]\n"
                        ],
                        [
                            23,
                            "  cross_zone_load_balancing   = true\n"
                        ],
                        [
                            24,
                            "  idle_timeout                = 400\n"
                        ],
                        [
                            25,
                            "  connection_draining         = true\n"
                        ],
                        [
                            26,
                            "  connection_draining_timeout = 400\n"
                        ],
                        [
                            27,
                            "\n"
                        ],
                        [
                            28,
                            "  tags = merge({\n"
                        ],
                        [
                            29,
                            "    Name = \"foobar-terraform-elb\"\n"
                        ],
                        [
                            30,
                            "    }, {\n"
                        ],
                        [
                            31,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            32,
                            "    git_file             = \"terraform/aws/elb.tf\"\n"
                        ],
                        [
                            33,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            34,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            35,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            36,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            37,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            38,
                            "    yor_trace            = \"b4a83ce9-9a45-43b4-b6d9-1783c282f702\"\n"
                        ],
                        [
                            39,
                            "  })\n"
                        ],
                        [
                            40,
                            "}"
                        ]
                    ],
                    "file_path": "/elb.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/elb.tf",
                    "repo_file_path": "/terragoat/terraform/aws/elb.tf",
                    "file_line_range": [
                        2,
                        40
                    ],
                    "resource": "aws_elb.weblb",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.ELBAccessLogs",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "foobar-terraform-elb",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/elb.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "b4a83ce9-9a45-43b4-b6d9-1783c282f702"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null
                },
                {
                    "check_id": "CKV_AWS_137",
                    "bc_check_id": null,
                    "check_name": "Ensure that Elasticsearch is configured inside a VPC",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "vpc_options"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n"
                        ],
                        [
                            2,
                            "  domain_name           = \"tg-${var.environment}-es\"\n"
                        ],
                        [
                            3,
                            "  elasticsearch_version = \"2.3\"\n"
                        ],
                        [
                            4,
                            "\n"
                        ],
                        [
                            5,
                            "  cluster_config {\n"
                        ],
                        [
                            6,
                            "    instance_type            = \"t2.small.elasticsearch\"\n"
                        ],
                        [
                            7,
                            "    instance_count           = 1\n"
                        ],
                        [
                            8,
                            "    dedicated_master_enabled = false\n"
                        ],
                        [
                            9,
                            "    dedicated_master_type    = \"m4.large.elasticsearch\"\n"
                        ],
                        [
                            10,
                            "    dedicated_master_count   = 1\n"
                        ],
                        [
                            11,
                            "  }\n"
                        ],
                        [
                            12,
                            "\n"
                        ],
                        [
                            13,
                            "  ebs_options {\n"
                        ],
                        [
                            14,
                            "    ebs_enabled = true\n"
                        ],
                        [
                            15,
                            "    volume_size = 30\n"
                        ],
                        [
                            16,
                            "  }\n"
                        ],
                        [
                            17,
                            "  tags = {\n"
                        ],
                        [
                            18,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            19,
                            "    git_file             = \"terraform/aws/es.tf\"\n"
                        ],
                        [
                            20,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            21,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            22,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            23,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            24,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            25,
                            "    yor_trace            = \"95131dec-d7c9-49bb-9aff-eb0e2736603b\"\n"
                        ],
                        [
                            26,
                            "  }\n"
                        ],
                        [
                            27,
                            "}\n"
                        ]
                    ],
                    "file_path": "/es.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/es.tf",
                    "repo_file_path": "/terragoat/terraform/aws/es.tf",
                    "file_line_range": [
                        1,
                        27
                    ],
                    "resource": "aws_elasticsearch_domain.monitoring-framework",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.ElasticsearchInVPC",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/es.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "domain_name": [
                            {
                                "type": "variable",
                                "name": "environment",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_elasticsearch_domain.monitoring-framework",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/es.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_5",
                    "bc_check_id": null,
                    "check_name": "Ensure all data stored in the Elasticsearch is securely encrypted at rest",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "encrypt_at_rest/[0]/enabled"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n"
                        ],
                        [
                            2,
                            "  domain_name           = \"tg-${var.environment}-es\"\n"
                        ],
                        [
                            3,
                            "  elasticsearch_version = \"2.3\"\n"
                        ],
                        [
                            4,
                            "\n"
                        ],
                        [
                            5,
                            "  cluster_config {\n"
                        ],
                        [
                            6,
                            "    instance_type            = \"t2.small.elasticsearch\"\n"
                        ],
                        [
                            7,
                            "    instance_count           = 1\n"
                        ],
                        [
                            8,
                            "    dedicated_master_enabled = false\n"
                        ],
                        [
                            9,
                            "    dedicated_master_type    = \"m4.large.elasticsearch\"\n"
                        ],
                        [
                            10,
                            "    dedicated_master_count   = 1\n"
                        ],
                        [
                            11,
                            "  }\n"
                        ],
                        [
                            12,
                            "\n"
                        ],
                        [
                            13,
                            "  ebs_options {\n"
                        ],
                        [
                            14,
                            "    ebs_enabled = true\n"
                        ],
                        [
                            15,
                            "    volume_size = 30\n"
                        ],
                        [
                            16,
                            "  }\n"
                        ],
                        [
                            17,
                            "  tags = {\n"
                        ],
                        [
                            18,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            19,
                            "    git_file             = \"terraform/aws/es.tf\"\n"
                        ],
                        [
                            20,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            21,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            22,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            23,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            24,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            25,
                            "    yor_trace            = \"95131dec-d7c9-49bb-9aff-eb0e2736603b\"\n"
                        ],
                        [
                            26,
                            "  }\n"
                        ],
                        [
                            27,
                            "}\n"
                        ]
                    ],
                    "file_path": "/es.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/es.tf",
                    "repo_file_path": "/terragoat/terraform/aws/es.tf",
                    "file_line_range": [
                        1,
                        27
                    ],
                    "resource": "aws_elasticsearch_domain.monitoring-framework",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.ElasticsearchEncryption",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/es.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "domain_name": [
                            {
                                "type": "variable",
                                "name": "environment",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_elasticsearch_domain.monitoring-framework",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/es.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_84",
                    "bc_check_id": null,
                    "check_name": "Ensure Elasticsearch Domain Logging is enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "log_publishing_options/[0]/cloudwatch_log_group_arn"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n"
                        ],
                        [
                            2,
                            "  domain_name           = \"tg-${var.environment}-es\"\n"
                        ],
                        [
                            3,
                            "  elasticsearch_version = \"2.3\"\n"
                        ],
                        [
                            4,
                            "\n"
                        ],
                        [
                            5,
                            "  cluster_config {\n"
                        ],
                        [
                            6,
                            "    instance_type            = \"t2.small.elasticsearch\"\n"
                        ],
                        [
                            7,
                            "    instance_count           = 1\n"
                        ],
                        [
                            8,
                            "    dedicated_master_enabled = false\n"
                        ],
                        [
                            9,
                            "    dedicated_master_type    = \"m4.large.elasticsearch\"\n"
                        ],
                        [
                            10,
                            "    dedicated_master_count   = 1\n"
                        ],
                        [
                            11,
                            "  }\n"
                        ],
                        [
                            12,
                            "\n"
                        ],
                        [
                            13,
                            "  ebs_options {\n"
                        ],
                        [
                            14,
                            "    ebs_enabled = true\n"
                        ],
                        [
                            15,
                            "    volume_size = 30\n"
                        ],
                        [
                            16,
                            "  }\n"
                        ],
                        [
                            17,
                            "  tags = {\n"
                        ],
                        [
                            18,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            19,
                            "    git_file             = \"terraform/aws/es.tf\"\n"
                        ],
                        [
                            20,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            21,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            22,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            23,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            24,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            25,
                            "    yor_trace            = \"95131dec-d7c9-49bb-9aff-eb0e2736603b\"\n"
                        ],
                        [
                            26,
                            "  }\n"
                        ],
                        [
                            27,
                            "}\n"
                        ]
                    ],
                    "file_path": "/es.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/es.tf",
                    "repo_file_path": "/terragoat/terraform/aws/es.tf",
                    "file_line_range": [
                        1,
                        27
                    ],
                    "resource": "aws_elasticsearch_domain.monitoring-framework",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.ElasticsearchDomainLogging",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/es.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "domain_name": [
                            {
                                "type": "variable",
                                "name": "environment",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_elasticsearch_domain.monitoring-framework",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/es.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_83",
                    "bc_check_id": null,
                    "check_name": "Ensure Elasticsearch Domain enforces HTTPS",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "domain_endpoint_options/[0]/enforce_https"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n"
                        ],
                        [
                            2,
                            "  domain_name           = \"tg-${var.environment}-es\"\n"
                        ],
                        [
                            3,
                            "  elasticsearch_version = \"2.3\"\n"
                        ],
                        [
                            4,
                            "\n"
                        ],
                        [
                            5,
                            "  cluster_config {\n"
                        ],
                        [
                            6,
                            "    instance_type            = \"t2.small.elasticsearch\"\n"
                        ],
                        [
                            7,
                            "    instance_count           = 1\n"
                        ],
                        [
                            8,
                            "    dedicated_master_enabled = false\n"
                        ],
                        [
                            9,
                            "    dedicated_master_type    = \"m4.large.elasticsearch\"\n"
                        ],
                        [
                            10,
                            "    dedicated_master_count   = 1\n"
                        ],
                        [
                            11,
                            "  }\n"
                        ],
                        [
                            12,
                            "\n"
                        ],
                        [
                            13,
                            "  ebs_options {\n"
                        ],
                        [
                            14,
                            "    ebs_enabled = true\n"
                        ],
                        [
                            15,
                            "    volume_size = 30\n"
                        ],
                        [
                            16,
                            "  }\n"
                        ],
                        [
                            17,
                            "  tags = {\n"
                        ],
                        [
                            18,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            19,
                            "    git_file             = \"terraform/aws/es.tf\"\n"
                        ],
                        [
                            20,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            21,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            22,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            23,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            24,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            25,
                            "    yor_trace            = \"95131dec-d7c9-49bb-9aff-eb0e2736603b\"\n"
                        ],
                        [
                            26,
                            "  }\n"
                        ],
                        [
                            27,
                            "}\n"
                        ]
                    ],
                    "file_path": "/es.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/es.tf",
                    "repo_file_path": "/terragoat/terraform/aws/es.tf",
                    "file_line_range": [
                        1,
                        27
                    ],
                    "resource": "aws_elasticsearch_domain.monitoring-framework",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.ElasticsearchDomainEnforceHTTPS",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/es.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "domain_name": [
                            {
                                "type": "variable",
                                "name": "environment",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_elasticsearch_domain.monitoring-framework",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/es.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_111",
                    "bc_check_id": null,
                    "check_name": "Ensure IAM policies does not allow write access without constraints",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            29,
                            "data aws_iam_policy_document \"policy\" {\n"
                        ],
                        [
                            30,
                            "  statement {\n"
                        ],
                        [
                            31,
                            "    actions = [\"es:*\"]\n"
                        ],
                        [
                            32,
                            "    principals {\n"
                        ],
                        [
                            33,
                            "      type        = \"AWS\"\n"
                        ],
                        [
                            34,
                            "      identifiers = [\"*\"]\n"
                        ],
                        [
                            35,
                            "    }\n"
                        ],
                        [
                            36,
                            "    resources = [\"*\"]\n"
                        ],
                        [
                            37,
                            "  }\n"
                        ],
                        [
                            38,
                            "}\n"
                        ]
                    ],
                    "file_path": "/es.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/es.tf",
                    "repo_file_path": "/terragoat/terraform/aws/es.tf",
                    "file_line_range": [
                        29,
                        38
                    ],
                    "resource": "aws_iam_policy_document.policy",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.data.aws.IAMWriteAccess",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null
                },
                {
                    "check_id": "CKV_AWS_109",
                    "bc_check_id": null,
                    "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            29,
                            "data aws_iam_policy_document \"policy\" {\n"
                        ],
                        [
                            30,
                            "  statement {\n"
                        ],
                        [
                            31,
                            "    actions = [\"es:*\"]\n"
                        ],
                        [
                            32,
                            "    principals {\n"
                        ],
                        [
                            33,
                            "      type        = \"AWS\"\n"
                        ],
                        [
                            34,
                            "      identifiers = [\"*\"]\n"
                        ],
                        [
                            35,
                            "    }\n"
                        ],
                        [
                            36,
                            "    resources = [\"*\"]\n"
                        ],
                        [
                            37,
                            "  }\n"
                        ],
                        [
                            38,
                            "}\n"
                        ]
                    ],
                    "file_path": "/es.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/es.tf",
                    "repo_file_path": "/terragoat/terraform/aws/es.tf",
                    "file_line_range": [
                        29,
                        38
                    ],
                    "resource": "aws_iam_policy_document.policy",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.data.aws.IAMPermissionsManagement",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null
                },
                {
                    "check_id": "CKV_AWS_40",
                    "bc_check_id": null,
                    "check_name": "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.)",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "user",
                            "users"
                        ]
                    },
                    "code_block": [
                        [
                            25,
                            "resource \"aws_iam_user_policy\" \"userpolicy\" {\n"
                        ],
                        [
                            26,
                            "  name = \"excess_policy\"\n"
                        ],
                        [
                            27,
                            "  user = \"${aws_iam_user.user.name}\"\n"
                        ],
                        [
                            28,
                            "\n"
                        ],
                        [
                            29,
                            "  policy = <<EOF\n"
                        ],
                        [
                            30,
                            "{\n"
                        ],
                        [
                            31,
                            "  \"Version\": \"2012-10-17\",\n"
                        ],
                        [
                            32,
                            "  \"Statement\": [\n"
                        ],
                        [
                            33,
                            "    {\n"
                        ],
                        [
                            34,
                            "      \"Action\": [\n"
                        ],
                        [
                            35,
                            "        \"ec2:*\",\n"
                        ],
                        [
                            36,
                            "        \"s3:*\",\n"
                        ],
                        [
                            37,
                            "        \"lambda:*\",\n"
                        ],
                        [
                            38,
                            "        \"cloudwatch:*\"\n"
                        ],
                        [
                            39,
                            "      ],\n"
                        ],
                        [
                            40,
                            "      \"Effect\": \"Allow\",\n"
                        ],
                        [
                            41,
                            "      \"Resource\": \"*\"\n"
                        ],
                        [
                            42,
                            "    }\n"
                        ],
                        [
                            43,
                            "  ]\n"
                        ],
                        [
                            44,
                            "}\n"
                        ],
                        [
                            45,
                            "EOF\n"
                        ],
                        [
                            46,
                            "}\n"
                        ]
                    ],
                    "file_path": "/iam.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/iam.tf",
                    "repo_file_path": "/terragoat/terraform/aws/iam.tf",
                    "file_line_range": [
                        25,
                        46
                    ],
                    "resource": "aws_iam_user_policy.userpolicy",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.IAMPolicyAttachedToGroupOrRoles",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "user": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            },
                            {
                                "type": "resource",
                                "name": "aws_iam_user.user",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/iam.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_7",
                    "bc_check_id": null,
                    "check_name": "Ensure rotation for customer created CMKs is enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "enable_key_rotation"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_kms_key\" \"logs_key\" {\n"
                        ],
                        [
                            2,
                            "  # key does not have rotation enabled\n"
                        ],
                        [
                            3,
                            "  description = \"${local.resource_prefix.value}-logs bucket key\"\n"
                        ],
                        [
                            4,
                            "\n"
                        ],
                        [
                            5,
                            "  deletion_window_in_days = 7\n"
                        ],
                        [
                            6,
                            "  tags = {\n"
                        ],
                        [
                            7,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            8,
                            "    git_file             = \"terraform/aws/kms.tf\"\n"
                        ],
                        [
                            9,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            10,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            11,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            12,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            13,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            14,
                            "    yor_trace            = \"cd8fa2a7-4868-4cd1-993d-da4644808ce5\"\n"
                        ],
                        [
                            15,
                            "  }\n"
                        ],
                        [
                            16,
                            "}\n"
                        ]
                    ],
                    "file_path": "/kms.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/kms.tf",
                    "repo_file_path": "/terragoat/terraform/aws/kms.tf",
                    "file_line_range": [
                        1,
                        16
                    ],
                    "resource": "aws_kms_key.logs_key",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.KMSRotation",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/kms.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "cd8fa2a7-4868-4cd1-993d-da4644808ce5"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "description": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_50",
                    "bc_check_id": null,
                    "check_name": "X-ray tracing is enabled for Lambda",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "tracing_config/[0]/mode"
                        ]
                    },
                    "code_block": [
                        [
                            31,
                            "resource \"aws_lambda_function\" \"analysis_lambda\" {\n"
                        ],
                        [
                            32,
                            "  # lambda have plain text secrets in environment variables\n"
                        ],
                        [
                            33,
                            "  filename      = \"resources/lambda_function_payload.zip\"\n"
                        ],
                        [
                            34,
                            "  function_name = \"${local.resource_prefix.value}-analysis\"\n"
                        ],
                        [
                            35,
                            "  role          = \"${aws_iam_role.iam_for_lambda.arn}\"\n"
                        ],
                        [
                            36,
                            "  handler       = \"exports.test\"\n"
                        ],
                        [
                            37,
                            "\n"
                        ],
                        [
                            38,
                            "  source_code_hash = \"${filebase64sha256(\"resources/lambda_function_payload.zip\")}\"\n"
                        ],
                        [
                            39,
                            "\n"
                        ],
                        [
                            40,
                            "  runtime = \"nodejs12.x\"\n"
                        ],
                        [
                            41,
                            "\n"
                        ],
                        [
                            42,
                            "  environment {\n"
                        ],
                        [
                            43,
                            "    variables = {\n"
                        ],
                        [
                            44,
                            "      access_key = \"AKIAIOSFODNN7EXAMPLE\"\n"
                        ],
                        [
                            45,
                            "      secret_key = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n"
                        ],
                        [
                            46,
                            "    }\n"
                        ],
                        [
                            47,
                            "  }\n"
                        ],
                        [
                            48,
                            "  tags = {\n"
                        ],
                        [
                            49,
                            "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"
                        ],
                        [
                            50,
                            "    git_file             = \"terraform/aws/lambda.tf\"\n"
                        ],
                        [
                            51,
                            "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"
                        ],
                        [
                            52,
                            "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"
                        ],
                        [
                            53,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            54,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            55,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            56,
                            "    yor_trace            = \"f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e\"\n"
                        ],
                        [
                            57,
                            "  }\n"
                        ],
                        [
                            58,
                            "}"
                        ]
                    ],
                    "file_path": "/lambda.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/lambda.tf",
                    "repo_file_path": "/terragoat/terraform/aws/lambda.tf",
                    "file_line_range": [
                        31,
                        58
                    ],
                    "resource": "aws_lambda_function.analysis_lambda",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.LambdaXrayEnabled",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542",
                        "git_file": "terraform/aws/lambda.tf",
                        "git_last_modified_at": "2021-05-02 10:06:10",
                        "git_last_modified_by": "nimrodkor@users.noreply.github.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "function_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_117",
                    "bc_check_id": null,
                    "check_name": "Ensure that AWS Lambda function is configured inside a VPC",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "vpc_config"
                        ]
                    },
                    "code_block": [
                        [
                            31,
                            "resource \"aws_lambda_function\" \"analysis_lambda\" {\n"
                        ],
                        [
                            32,
                            "  # lambda have plain text secrets in environment variables\n"
                        ],
                        [
                            33,
                            "  filename      = \"resources/lambda_function_payload.zip\"\n"
                        ],
                        [
                            34,
                            "  function_name = \"${local.resource_prefix.value}-analysis\"\n"
                        ],
                        [
                            35,
                            "  role          = \"${aws_iam_role.iam_for_lambda.arn}\"\n"
                        ],
                        [
                            36,
                            "  handler       = \"exports.test\"\n"
                        ],
                        [
                            37,
                            "\n"
                        ],
                        [
                            38,
                            "  source_code_hash = \"${filebase64sha256(\"resources/lambda_function_payload.zip\")}\"\n"
                        ],
                        [
                            39,
                            "\n"
                        ],
                        [
                            40,
                            "  runtime = \"nodejs12.x\"\n"
                        ],
                        [
                            41,
                            "\n"
                        ],
                        [
                            42,
                            "  environment {\n"
                        ],
                        [
                            43,
                            "    variables = {\n"
                        ],
                        [
                            44,
                            "      access_key = \"AKIAIOSFODNN7EXAMPLE\"\n"
                        ],
                        [
                            45,
                            "      secret_key = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n"
                        ],
                        [
                            46,
                            "    }\n"
                        ],
                        [
                            47,
                            "  }\n"
                        ],
                        [
                            48,
                            "  tags = {\n"
                        ],
                        [
                            49,
                            "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"
                        ],
                        [
                            50,
                            "    git_file             = \"terraform/aws/lambda.tf\"\n"
                        ],
                        [
                            51,
                            "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"
                        ],
                        [
                            52,
                            "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"
                        ],
                        [
                            53,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            54,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            55,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            56,
                            "    yor_trace            = \"f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e\"\n"
                        ],
                        [
                            57,
                            "  }\n"
                        ],
                        [
                            58,
                            "}"
                        ]
                    ],
                    "file_path": "/lambda.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/lambda.tf",
                    "repo_file_path": "/terragoat/terraform/aws/lambda.tf",
                    "file_line_range": [
                        31,
                        58
                    ],
                    "resource": "aws_lambda_function.analysis_lambda",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.LambdaInVPC",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542",
                        "git_file": "terraform/aws/lambda.tf",
                        "git_last_modified_at": "2021-05-02 10:06:10",
                        "git_last_modified_by": "nimrodkor@users.noreply.github.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "function_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_116",
                    "bc_check_id": null,
                    "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "dead_letter_config/[0]/target_arn"
                        ]
                    },
                    "code_block": [
                        [
                            31,
                            "resource \"aws_lambda_function\" \"analysis_lambda\" {\n"
                        ],
                        [
                            32,
                            "  # lambda have plain text secrets in environment variables\n"
                        ],
                        [
                            33,
                            "  filename      = \"resources/lambda_function_payload.zip\"\n"
                        ],
                        [
                            34,
                            "  function_name = \"${local.resource_prefix.value}-analysis\"\n"
                        ],
                        [
                            35,
                            "  role          = \"${aws_iam_role.iam_for_lambda.arn}\"\n"
                        ],
                        [
                            36,
                            "  handler       = \"exports.test\"\n"
                        ],
                        [
                            37,
                            "\n"
                        ],
                        [
                            38,
                            "  source_code_hash = \"${filebase64sha256(\"resources/lambda_function_payload.zip\")}\"\n"
                        ],
                        [
                            39,
                            "\n"
                        ],
                        [
                            40,
                            "  runtime = \"nodejs12.x\"\n"
                        ],
                        [
                            41,
                            "\n"
                        ],
                        [
                            42,
                            "  environment {\n"
                        ],
                        [
                            43,
                            "    variables = {\n"
                        ],
                        [
                            44,
                            "      access_key = \"AKIAIOSFODNN7EXAMPLE\"\n"
                        ],
                        [
                            45,
                            "      secret_key = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n"
                        ],
                        [
                            46,
                            "    }\n"
                        ],
                        [
                            47,
                            "  }\n"
                        ],
                        [
                            48,
                            "  tags = {\n"
                        ],
                        [
                            49,
                            "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"
                        ],
                        [
                            50,
                            "    git_file             = \"terraform/aws/lambda.tf\"\n"
                        ],
                        [
                            51,
                            "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"
                        ],
                        [
                            52,
                            "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"
                        ],
                        [
                            53,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            54,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            55,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            56,
                            "    yor_trace            = \"f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e\"\n"
                        ],
                        [
                            57,
                            "  }\n"
                        ],
                        [
                            58,
                            "}"
                        ]
                    ],
                    "file_path": "/lambda.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/lambda.tf",
                    "repo_file_path": "/terragoat/terraform/aws/lambda.tf",
                    "file_line_range": [
                        31,
                        58
                    ],
                    "resource": "aws_lambda_function.analysis_lambda",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.LambdaDLQConfigured",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542",
                        "git_file": "terraform/aws/lambda.tf",
                        "git_last_modified_at": "2021-05-02 10:06:10",
                        "git_last_modified_by": "nimrodkor@users.noreply.github.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "function_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_173",
                    "bc_check_id": null,
                    "check_name": "Check encryption settings for Lambda environmental variable",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "environment/[0]/variables"
                        ]
                    },
                    "code_block": [
                        [
                            31,
                            "resource \"aws_lambda_function\" \"analysis_lambda\" {\n"
                        ],
                        [
                            32,
                            "  # lambda have plain text secrets in environment variables\n"
                        ],
                        [
                            33,
                            "  filename      = \"resources/lambda_function_payload.zip\"\n"
                        ],
                        [
                            34,
                            "  function_name = \"${local.resource_prefix.value}-analysis\"\n"
                        ],
                        [
                            35,
                            "  role          = \"${aws_iam_role.iam_for_lambda.arn}\"\n"
                        ],
                        [
                            36,
                            "  handler       = \"exports.test\"\n"
                        ],
                        [
                            37,
                            "\n"
                        ],
                        [
                            38,
                            "  source_code_hash = \"${filebase64sha256(\"resources/lambda_function_payload.zip\")}\"\n"
                        ],
                        [
                            39,
                            "\n"
                        ],
                        [
                            40,
                            "  runtime = \"nodejs12.x\"\n"
                        ],
                        [
                            41,
                            "\n"
                        ],
                        [
                            42,
                            "  environment {\n"
                        ],
                        [
                            43,
                            "    variables = {\n"
                        ],
                        [
                            44,
                            "      access_key = \"AKIAIOSFODNN7EXAMPLE\"\n"
                        ],
                        [
                            45,
                            "      secret_key = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n"
                        ],
                        [
                            46,
                            "    }\n"
                        ],
                        [
                            47,
                            "  }\n"
                        ],
                        [
                            48,
                            "  tags = {\n"
                        ],
                        [
                            49,
                            "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"
                        ],
                        [
                            50,
                            "    git_file             = \"terraform/aws/lambda.tf\"\n"
                        ],
                        [
                            51,
                            "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"
                        ],
                        [
                            52,
                            "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"
                        ],
                        [
                            53,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            54,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            55,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            56,
                            "    yor_trace            = \"f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e\"\n"
                        ],
                        [
                            57,
                            "  }\n"
                        ],
                        [
                            58,
                            "}"
                        ]
                    ],
                    "file_path": "/lambda.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/lambda.tf",
                    "repo_file_path": "/terragoat/terraform/aws/lambda.tf",
                    "file_line_range": [
                        31,
                        58
                    ],
                    "resource": "aws_lambda_function.analysis_lambda",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.LambdaEnvironmentEncryptionSettings",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542",
                        "git_file": "terraform/aws/lambda.tf",
                        "git_last_modified_at": "2021-05-02 10:06:10",
                        "git_last_modified_by": "nimrodkor@users.noreply.github.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "function_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_45",
                    "bc_check_id": null,
                    "check_name": "Ensure no hard-coded secrets exist in lambda environment",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "environment/[0]/variables"
                        ]
                    },
                    "code_block": [
                        [
                            31,
                            "resource \"aws_lambda_function\" \"analysis_lambda\" {\n"
                        ],
                        [
                            32,
                            "  # lambda have plain text secrets in environment variables\n"
                        ],
                        [
                            33,
                            "  filename      = \"resources/lambda_function_payload.zip\"\n"
                        ],
                        [
                            34,
                            "  function_name = \"${local.resource_prefix.value}-analysis\"\n"
                        ],
                        [
                            35,
                            "  role          = \"${aws_iam_role.iam_for_lambda.arn}\"\n"
                        ],
                        [
                            36,
                            "  handler       = \"exports.test\"\n"
                        ],
                        [
                            37,
                            "\n"
                        ],
                        [
                            38,
                            "  source_code_hash = \"${filebase64sha256(\"resources/lambda_function_payload.zip\")}\"\n"
                        ],
                        [
                            39,
                            "\n"
                        ],
                        [
                            40,
                            "  runtime = \"nodejs12.x\"\n"
                        ],
                        [
                            41,
                            "\n"
                        ],
                        [
                            42,
                            "  environment {\n"
                        ],
                        [
                            43,
                            "    variables = {\n"
                        ],
                        [
                            44,
                            "      access_key = \"AKIAIOSFODNN7EXAMPLE\"\n"
                        ],
                        [
                            45,
                            "      secret_key = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n"
                        ],
                        [
                            46,
                            "    }\n"
                        ],
                        [
                            47,
                            "  }\n"
                        ],
                        [
                            48,
                            "  tags = {\n"
                        ],
                        [
                            49,
                            "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"
                        ],
                        [
                            50,
                            "    git_file             = \"terraform/aws/lambda.tf\"\n"
                        ],
                        [
                            51,
                            "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"
                        ],
                        [
                            52,
                            "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"
                        ],
                        [
                            53,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            54,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            55,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            56,
                            "    yor_trace            = \"f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e\"\n"
                        ],
                        [
                            57,
                            "  }\n"
                        ],
                        [
                            58,
                            "}"
                        ]
                    ],
                    "file_path": "/lambda.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/lambda.tf",
                    "repo_file_path": "/terragoat/terraform/aws/lambda.tf",
                    "file_line_range": [
                        31,
                        58
                    ],
                    "resource": "aws_lambda_function.analysis_lambda",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.LambdaEnvironmentCredentials",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542",
                        "git_file": "terraform/aws/lambda.tf",
                        "git_last_modified_at": "2021-05-02 10:06:10",
                        "git_last_modified_by": "nimrodkor@users.noreply.github.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "function_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_115",
                    "bc_check_id": null,
                    "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "reserved_concurrent_executions/[0]"
                        ]
                    },
                    "code_block": [
                        [
                            31,
                            "resource \"aws_lambda_function\" \"analysis_lambda\" {\n"
                        ],
                        [
                            32,
                            "  # lambda have plain text secrets in environment variables\n"
                        ],
                        [
                            33,
                            "  filename      = \"resources/lambda_function_payload.zip\"\n"
                        ],
                        [
                            34,
                            "  function_name = \"${local.resource_prefix.value}-analysis\"\n"
                        ],
                        [
                            35,
                            "  role          = \"${aws_iam_role.iam_for_lambda.arn}\"\n"
                        ],
                        [
                            36,
                            "  handler       = \"exports.test\"\n"
                        ],
                        [
                            37,
                            "\n"
                        ],
                        [
                            38,
                            "  source_code_hash = \"${filebase64sha256(\"resources/lambda_function_payload.zip\")}\"\n"
                        ],
                        [
                            39,
                            "\n"
                        ],
                        [
                            40,
                            "  runtime = \"nodejs12.x\"\n"
                        ],
                        [
                            41,
                            "\n"
                        ],
                        [
                            42,
                            "  environment {\n"
                        ],
                        [
                            43,
                            "    variables = {\n"
                        ],
                        [
                            44,
                            "      access_key = \"AKIAIOSFODNN7EXAMPLE\"\n"
                        ],
                        [
                            45,
                            "      secret_key = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n"
                        ],
                        [
                            46,
                            "    }\n"
                        ],
                        [
                            47,
                            "  }\n"
                        ],
                        [
                            48,
                            "  tags = {\n"
                        ],
                        [
                            49,
                            "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"
                        ],
                        [
                            50,
                            "    git_file             = \"terraform/aws/lambda.tf\"\n"
                        ],
                        [
                            51,
                            "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"
                        ],
                        [
                            52,
                            "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"
                        ],
                        [
                            53,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            54,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            55,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            56,
                            "    yor_trace            = \"f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e\"\n"
                        ],
                        [
                            57,
                            "  }\n"
                        ],
                        [
                            58,
                            "}"
                        ]
                    ],
                    "file_path": "/lambda.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/lambda.tf",
                    "repo_file_path": "/terragoat/terraform/aws/lambda.tf",
                    "file_line_range": [
                        31,
                        58
                    ],
                    "resource": "aws_lambda_function.analysis_lambda",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542",
                        "git_file": "terraform/aws/lambda.tf",
                        "git_last_modified_at": "2021-05-02 10:06:10",
                        "git_last_modified_by": "nimrodkor@users.noreply.github.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "function_name": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_101",
                    "bc_check_id": null,
                    "check_name": "Ensure Neptune logging is enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "enable_cloudwatch_logs_exports"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_neptune_cluster\" \"default\" {\n"
                        ],
                        [
                            2,
                            "  cluster_identifier                  = var.neptune-dbname\n"
                        ],
                        [
                            3,
                            "  engine                              = \"neptune\"\n"
                        ],
                        [
                            4,
                            "  backup_retention_period             = 5\n"
                        ],
                        [
                            5,
                            "  preferred_backup_window             = \"07:00-09:00\"\n"
                        ],
                        [
                            6,
                            "  skip_final_snapshot                 = true\n"
                        ],
                        [
                            7,
                            "  iam_database_authentication_enabled = false\n"
                        ],
                        [
                            8,
                            "  apply_immediately                   = true\n"
                        ],
                        [
                            9,
                            "  storage_encrypted                   = false\n"
                        ],
                        [
                            10,
                            "  tags = {\n"
                        ],
                        [
                            11,
                            "    git_commit           = \"aa8fd16fd94cccf6af206e2f0922b5558f8ac514\"\n"
                        ],
                        [
                            12,
                            "    git_file             = \"terraform/aws/neptune.tf\"\n"
                        ],
                        [
                            13,
                            "    git_last_modified_at = \"2020-08-21 19:14:35\"\n"
                        ],
                        [
                            14,
                            "    git_last_modified_by = \"matt@bridgecrew.io\"\n"
                        ],
                        [
                            15,
                            "    git_modifiers        = \"matt\"\n"
                        ],
                        [
                            16,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            17,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            18,
                            "    yor_trace            = \"0d4cbb85-73ed-4ca0-b1da-296e4185f34e\"\n"
                        ],
                        [
                            19,
                            "  }\n"
                        ],
                        [
                            20,
                            "}\n"
                        ]
                    ],
                    "file_path": "/neptune.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/neptune.tf",
                    "repo_file_path": "/terragoat/terraform/aws/neptune.tf",
                    "file_line_range": [
                        1,
                        20
                    ],
                    "resource": "aws_neptune_cluster.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.NeptuneClusterLogging",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "aa8fd16fd94cccf6af206e2f0922b5558f8ac514",
                        "git_file": "terraform/aws/neptune.tf",
                        "git_last_modified_at": "2020-08-21 19:14:35",
                        "git_last_modified_by": "matt@bridgecrew.io",
                        "git_modifiers": "matt",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "0d4cbb85-73ed-4ca0-b1da-296e4185f34e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "cluster_identifier": [
                            {
                                "type": "variable",
                                "name": "neptune-dbname",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_44",
                    "bc_check_id": null,
                    "check_name": "Ensure Neptune storage is securely encrypted",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "storage_encrypted"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_neptune_cluster\" \"default\" {\n"
                        ],
                        [
                            2,
                            "  cluster_identifier                  = var.neptune-dbname\n"
                        ],
                        [
                            3,
                            "  engine                              = \"neptune\"\n"
                        ],
                        [
                            4,
                            "  backup_retention_period             = 5\n"
                        ],
                        [
                            5,
                            "  preferred_backup_window             = \"07:00-09:00\"\n"
                        ],
                        [
                            6,
                            "  skip_final_snapshot                 = true\n"
                        ],
                        [
                            7,
                            "  iam_database_authentication_enabled = false\n"
                        ],
                        [
                            8,
                            "  apply_immediately                   = true\n"
                        ],
                        [
                            9,
                            "  storage_encrypted                   = false\n"
                        ],
                        [
                            10,
                            "  tags = {\n"
                        ],
                        [
                            11,
                            "    git_commit           = \"aa8fd16fd94cccf6af206e2f0922b5558f8ac514\"\n"
                        ],
                        [
                            12,
                            "    git_file             = \"terraform/aws/neptune.tf\"\n"
                        ],
                        [
                            13,
                            "    git_last_modified_at = \"2020-08-21 19:14:35\"\n"
                        ],
                        [
                            14,
                            "    git_last_modified_by = \"matt@bridgecrew.io\"\n"
                        ],
                        [
                            15,
                            "    git_modifiers        = \"matt\"\n"
                        ],
                        [
                            16,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            17,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            18,
                            "    yor_trace            = \"0d4cbb85-73ed-4ca0-b1da-296e4185f34e\"\n"
                        ],
                        [
                            19,
                            "  }\n"
                        ],
                        [
                            20,
                            "}\n"
                        ]
                    ],
                    "file_path": "/neptune.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/neptune.tf",
                    "repo_file_path": "/terragoat/terraform/aws/neptune.tf",
                    "file_line_range": [
                        1,
                        20
                    ],
                    "resource": "aws_neptune_cluster.default",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.NeptuneClusterStorageEncrypted",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "aa8fd16fd94cccf6af206e2f0922b5558f8ac514",
                        "git_file": "terraform/aws/neptune.tf",
                        "git_last_modified_at": "2020-08-21 19:14:35",
                        "git_last_modified_by": "matt@bridgecrew.io",
                        "git_modifiers": "matt",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "0d4cbb85-73ed-4ca0-b1da-296e4185f34e"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "cluster_identifier": [
                            {
                                "type": "variable",
                                "name": "neptune-dbname",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_41",
                    "bc_check_id": null,
                    "check_name": "Ensure no hard coded AWS access key and secret key exists in provider",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": []
                    },
                    "code_block": [
                        [
                            7,
                            "provider \"aws\" {\n"
                        ],
                        [
                            8,
                            "  alias      = \"plain_text_access_keys_provider\"\n"
                        ],
                        [
                            9,
                            "  region     = \"us-west-1\"\n"
                        ],
                        [
                            10,
                            "  access_key = \"AKIAIOSFODNN7EXAMPLE\"\n"
                        ],
                        [
                            11,
                            "  secret_key = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n"
                        ],
                        [
                            12,
                            "}\n"
                        ]
                    ],
                    "file_path": "/providers.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/providers.tf",
                    "repo_file_path": "/terragoat/terraform/aws/providers.tf",
                    "file_line_range": [
                        7,
                        12
                    ],
                    "resource": "aws.plain_text_access_keys_provider",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.provider.aws.credentials",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null
                },
                {
                    "check_id": "CKV_AWS_19",
                    "bc_check_id": null,
                    "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "server_side_encryption_configuration/[0]/rule/[0]/apply_server_side_encryption_by_default/[0]/sse_algorithm"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_s3_bucket\" \"data\" {\n"
                        ],
                        [
                            2,
                            "  # bucket is public\n"
                        ],
                        [
                            3,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            4,
                            "  # bucket does not have access logs\n"
                        ],
                        [
                            5,
                            "  # bucket does not have versioning\n"
                        ],
                        [
                            6,
                            "  bucket        = \"${local.resource_prefix.value}-data\"\n"
                        ],
                        [
                            7,
                            "  acl           = \"public-read\"\n"
                        ],
                        [
                            8,
                            "  force_destroy = true\n"
                        ],
                        [
                            9,
                            "  tags = merge({\n"
                        ],
                        [
                            10,
                            "    Name        = \"${local.resource_prefix.value}-data\"\n"
                        ],
                        [
                            11,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            12,
                            "    }, {\n"
                        ],
                        [
                            13,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            14,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            15,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            16,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            17,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            18,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            19,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            20,
                            "    yor_trace            = \"0874007d-903a-4b4c-945f-c9c233e13243\"\n"
                        ],
                        [
                            21,
                            "  })\n"
                        ],
                        [
                            22,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        1,
                        22
                    ],
                    "resource": "aws_s3_bucket.data",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3Encryption",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-data",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_20",
                    "bc_check_id": null,
                    "check_name": "S3 Bucket has an ACL defined which allows public READ access.",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "acl"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_s3_bucket\" \"data\" {\n"
                        ],
                        [
                            2,
                            "  # bucket is public\n"
                        ],
                        [
                            3,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            4,
                            "  # bucket does not have access logs\n"
                        ],
                        [
                            5,
                            "  # bucket does not have versioning\n"
                        ],
                        [
                            6,
                            "  bucket        = \"${local.resource_prefix.value}-data\"\n"
                        ],
                        [
                            7,
                            "  acl           = \"public-read\"\n"
                        ],
                        [
                            8,
                            "  force_destroy = true\n"
                        ],
                        [
                            9,
                            "  tags = merge({\n"
                        ],
                        [
                            10,
                            "    Name        = \"${local.resource_prefix.value}-data\"\n"
                        ],
                        [
                            11,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            12,
                            "    }, {\n"
                        ],
                        [
                            13,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            14,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            15,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            16,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            17,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            18,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            19,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            20,
                            "    yor_trace            = \"0874007d-903a-4b4c-945f-c9c233e13243\"\n"
                        ],
                        [
                            21,
                            "  })\n"
                        ],
                        [
                            22,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        1,
                        22
                    ],
                    "resource": "aws_s3_bucket.data",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3PublicACLRead",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-data",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_18",
                    "bc_check_id": null,
                    "check_name": "Ensure the S3 bucket has access logging enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "logging"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_s3_bucket\" \"data\" {\n"
                        ],
                        [
                            2,
                            "  # bucket is public\n"
                        ],
                        [
                            3,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            4,
                            "  # bucket does not have access logs\n"
                        ],
                        [
                            5,
                            "  # bucket does not have versioning\n"
                        ],
                        [
                            6,
                            "  bucket        = \"${local.resource_prefix.value}-data\"\n"
                        ],
                        [
                            7,
                            "  acl           = \"public-read\"\n"
                        ],
                        [
                            8,
                            "  force_destroy = true\n"
                        ],
                        [
                            9,
                            "  tags = merge({\n"
                        ],
                        [
                            10,
                            "    Name        = \"${local.resource_prefix.value}-data\"\n"
                        ],
                        [
                            11,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            12,
                            "    }, {\n"
                        ],
                        [
                            13,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            14,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            15,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            16,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            17,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            18,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            19,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            20,
                            "    yor_trace            = \"0874007d-903a-4b4c-945f-c9c233e13243\"\n"
                        ],
                        [
                            21,
                            "  })\n"
                        ],
                        [
                            22,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        1,
                        22
                    ],
                    "resource": "aws_s3_bucket.data",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3AccessLogs",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-data",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_144",
                    "bc_check_id": null,
                    "check_name": "Ensure that S3 bucket has cross-region replication enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "replication_configuration/[0]/role"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_s3_bucket\" \"data\" {\n"
                        ],
                        [
                            2,
                            "  # bucket is public\n"
                        ],
                        [
                            3,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            4,
                            "  # bucket does not have access logs\n"
                        ],
                        [
                            5,
                            "  # bucket does not have versioning\n"
                        ],
                        [
                            6,
                            "  bucket        = \"${local.resource_prefix.value}-data\"\n"
                        ],
                        [
                            7,
                            "  acl           = \"public-read\"\n"
                        ],
                        [
                            8,
                            "  force_destroy = true\n"
                        ],
                        [
                            9,
                            "  tags = merge({\n"
                        ],
                        [
                            10,
                            "    Name        = \"${local.resource_prefix.value}-data\"\n"
                        ],
                        [
                            11,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            12,
                            "    }, {\n"
                        ],
                        [
                            13,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            14,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            15,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            16,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            17,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            18,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            19,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            20,
                            "    yor_trace            = \"0874007d-903a-4b4c-945f-c9c233e13243\"\n"
                        ],
                        [
                            21,
                            "  })\n"
                        ],
                        [
                            22,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        1,
                        22
                    ],
                    "resource": "aws_s3_bucket.data",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3BucketReplicationConfiguration",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-data",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_145",
                    "bc_check_id": null,
                    "check_name": "Ensure that S3 buckets are encrypted with KMS by default",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "server_side_encryption_configuration/[0]/rule/[0]/apply_server_side_encryption_by_default/[0]/sse_algorithm"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_s3_bucket\" \"data\" {\n"
                        ],
                        [
                            2,
                            "  # bucket is public\n"
                        ],
                        [
                            3,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            4,
                            "  # bucket does not have access logs\n"
                        ],
                        [
                            5,
                            "  # bucket does not have versioning\n"
                        ],
                        [
                            6,
                            "  bucket        = \"${local.resource_prefix.value}-data\"\n"
                        ],
                        [
                            7,
                            "  acl           = \"public-read\"\n"
                        ],
                        [
                            8,
                            "  force_destroy = true\n"
                        ],
                        [
                            9,
                            "  tags = merge({\n"
                        ],
                        [
                            10,
                            "    Name        = \"${local.resource_prefix.value}-data\"\n"
                        ],
                        [
                            11,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            12,
                            "    }, {\n"
                        ],
                        [
                            13,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            14,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            15,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            16,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            17,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            18,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            19,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            20,
                            "    yor_trace            = \"0874007d-903a-4b4c-945f-c9c233e13243\"\n"
                        ],
                        [
                            21,
                            "  })\n"
                        ],
                        [
                            22,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        1,
                        22
                    ],
                    "resource": "aws_s3_bucket.data",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3KMSEncryptedByDefault",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-data",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_21",
                    "bc_check_id": null,
                    "check_name": "Ensure all data stored in the S3 bucket have versioning enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "versioning/[0]/enabled"
                        ]
                    },
                    "code_block": [
                        [
                            1,
                            "resource \"aws_s3_bucket\" \"data\" {\n"
                        ],
                        [
                            2,
                            "  # bucket is public\n"
                        ],
                        [
                            3,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            4,
                            "  # bucket does not have access logs\n"
                        ],
                        [
                            5,
                            "  # bucket does not have versioning\n"
                        ],
                        [
                            6,
                            "  bucket        = \"${local.resource_prefix.value}-data\"\n"
                        ],
                        [
                            7,
                            "  acl           = \"public-read\"\n"
                        ],
                        [
                            8,
                            "  force_destroy = true\n"
                        ],
                        [
                            9,
                            "  tags = merge({\n"
                        ],
                        [
                            10,
                            "    Name        = \"${local.resource_prefix.value}-data\"\n"
                        ],
                        [
                            11,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            12,
                            "    }, {\n"
                        ],
                        [
                            13,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            14,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            15,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            16,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            17,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            18,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            19,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            20,
                            "    yor_trace            = \"0874007d-903a-4b4c-945f-c9c233e13243\"\n"
                        ],
                        [
                            21,
                            "  })\n"
                        ],
                        [
                            22,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        1,
                        22
                    ],
                    "resource": "aws_s3_bucket.data",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3Versioning",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-data",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_19",
                    "bc_check_id": null,
                    "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "server_side_encryption_configuration/[0]/rule/[0]/apply_server_side_encryption_by_default/[0]/sse_algorithm"
                        ]
                    },
                    "code_block": [
                        [
                            43,
                            "resource \"aws_s3_bucket\" \"financials\" {\n"
                        ],
                        [
                            44,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            45,
                            "  # bucket does not have access logs\n"
                        ],
                        [
                            46,
                            "  # bucket does not have versioning\n"
                        ],
                        [
                            47,
                            "  bucket        = \"${local.resource_prefix.value}-financials\"\n"
                        ],
                        [
                            48,
                            "  acl           = \"private\"\n"
                        ],
                        [
                            49,
                            "  force_destroy = true\n"
                        ],
                        [
                            50,
                            "  tags = merge({\n"
                        ],
                        [
                            51,
                            "    Name        = \"${local.resource_prefix.value}-financials\"\n"
                        ],
                        [
                            52,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            53,
                            "    }, {\n"
                        ],
                        [
                            54,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            55,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            56,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            57,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            58,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            59,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            60,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            61,
                            "    yor_trace            = \"0e012640-b597-4e5d-9378-d4b584aea913\"\n"
                        ],
                        [
                            62,
                            "  })\n"
                        ],
                        [
                            63,
                            "\n"
                        ],
                        [
                            64,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        43,
                        64
                    ],
                    "resource": "aws_s3_bucket.financials",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3Encryption",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-financials",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_18",
                    "bc_check_id": null,
                    "check_name": "Ensure the S3 bucket has access logging enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "logging"
                        ]
                    },
                    "code_block": [
                        [
                            43,
                            "resource \"aws_s3_bucket\" \"financials\" {\n"
                        ],
                        [
                            44,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            45,
                            "  # bucket does not have access logs\n"
                        ],
                        [
                            46,
                            "  # bucket does not have versioning\n"
                        ],
                        [
                            47,
                            "  bucket        = \"${local.resource_prefix.value}-financials\"\n"
                        ],
                        [
                            48,
                            "  acl           = \"private\"\n"
                        ],
                        [
                            49,
                            "  force_destroy = true\n"
                        ],
                        [
                            50,
                            "  tags = merge({\n"
                        ],
                        [
                            51,
                            "    Name        = \"${local.resource_prefix.value}-financials\"\n"
                        ],
                        [
                            52,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            53,
                            "    }, {\n"
                        ],
                        [
                            54,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            55,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            56,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            57,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            58,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            59,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            60,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            61,
                            "    yor_trace            = \"0e012640-b597-4e5d-9378-d4b584aea913\"\n"
                        ],
                        [
                            62,
                            "  })\n"
                        ],
                        [
                            63,
                            "\n"
                        ],
                        [
                            64,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        43,
                        64
                    ],
                    "resource": "aws_s3_bucket.financials",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3AccessLogs",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-financials",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_144",
                    "bc_check_id": null,
                    "check_name": "Ensure that S3 bucket has cross-region replication enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "replication_configuration/[0]/role"
                        ]
                    },
                    "code_block": [
                        [
                            43,
                            "resource \"aws_s3_bucket\" \"financials\" {\n"
                        ],
                        [
                            44,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            45,
                            "  # bucket does not have access logs\n"
                        ],
                        [
                            46,
                            "  # bucket does not have versioning\n"
                        ],
                        [
                            47,
                            "  bucket        = \"${local.resource_prefix.value}-financials\"\n"
                        ],
                        [
                            48,
                            "  acl           = \"private\"\n"
                        ],
                        [
                            49,
                            "  force_destroy = true\n"
                        ],
                        [
                            50,
                            "  tags = merge({\n"
                        ],
                        [
                            51,
                            "    Name        = \"${local.resource_prefix.value}-financials\"\n"
                        ],
                        [
                            52,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            53,
                            "    }, {\n"
                        ],
                        [
                            54,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            55,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            56,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            57,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            58,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            59,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            60,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            61,
                            "    yor_trace            = \"0e012640-b597-4e5d-9378-d4b584aea913\"\n"
                        ],
                        [
                            62,
                            "  })\n"
                        ],
                        [
                            63,
                            "\n"
                        ],
                        [
                            64,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        43,
                        64
                    ],
                    "resource": "aws_s3_bucket.financials",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3BucketReplicationConfiguration",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-financials",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_145",
                    "bc_check_id": null,
                    "check_name": "Ensure that S3 buckets are encrypted with KMS by default",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "server_side_encryption_configuration/[0]/rule/[0]/apply_server_side_encryption_by_default/[0]/sse_algorithm"
                        ]
                    },
                    "code_block": [
                        [
                            43,
                            "resource \"aws_s3_bucket\" \"financials\" {\n"
                        ],
                        [
                            44,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            45,
                            "  # bucket does not have access logs\n"
                        ],
                        [
                            46,
                            "  # bucket does not have versioning\n"
                        ],
                        [
                            47,
                            "  bucket        = \"${local.resource_prefix.value}-financials\"\n"
                        ],
                        [
                            48,
                            "  acl           = \"private\"\n"
                        ],
                        [
                            49,
                            "  force_destroy = true\n"
                        ],
                        [
                            50,
                            "  tags = merge({\n"
                        ],
                        [
                            51,
                            "    Name        = \"${local.resource_prefix.value}-financials\"\n"
                        ],
                        [
                            52,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            53,
                            "    }, {\n"
                        ],
                        [
                            54,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            55,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            56,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            57,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            58,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            59,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            60,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            61,
                            "    yor_trace            = \"0e012640-b597-4e5d-9378-d4b584aea913\"\n"
                        ],
                        [
                            62,
                            "  })\n"
                        ],
                        [
                            63,
                            "\n"
                        ],
                        [
                            64,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        43,
                        64
                    ],
                    "resource": "aws_s3_bucket.financials",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3KMSEncryptedByDefault",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-financials",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_21",
                    "bc_check_id": null,
                    "check_name": "Ensure all data stored in the S3 bucket have versioning enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "versioning/[0]/enabled"
                        ]
                    },
                    "code_block": [
                        [
                            43,
                            "resource \"aws_s3_bucket\" \"financials\" {\n"
                        ],
                        [
                            44,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            45,
                            "  # bucket does not have access logs\n"
                        ],
                        [
                            46,
                            "  # bucket does not have versioning\n"
                        ],
                        [
                            47,
                            "  bucket        = \"${local.resource_prefix.value}-financials\"\n"
                        ],
                        [
                            48,
                            "  acl           = \"private\"\n"
                        ],
                        [
                            49,
                            "  force_destroy = true\n"
                        ],
                        [
                            50,
                            "  tags = merge({\n"
                        ],
                        [
                            51,
                            "    Name        = \"${local.resource_prefix.value}-financials\"\n"
                        ],
                        [
                            52,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            53,
                            "    }, {\n"
                        ],
                        [
                            54,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            55,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            56,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            57,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            58,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            59,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            60,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            61,
                            "    yor_trace            = \"0e012640-b597-4e5d-9378-d4b584aea913\"\n"
                        ],
                        [
                            62,
                            "  })\n"
                        ],
                        [
                            63,
                            "\n"
                        ],
                        [
                            64,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        43,
                        64
                    ],
                    "resource": "aws_s3_bucket.financials",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3Versioning",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-financials",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_19",
                    "bc_check_id": null,
                    "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "server_side_encryption_configuration/[0]/rule/[0]/apply_server_side_encryption_by_default/[0]/sse_algorithm"
                        ]
                    },
                    "code_block": [
                        [
                            66,
                            "resource \"aws_s3_bucket\" \"operations\" {\n"
                        ],
                        [
                            67,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            68,
                            "  # bucket does not have access logs\n"
                        ],
                        [
                            69,
                            "  bucket = \"${local.resource_prefix.value}-operations\"\n"
                        ],
                        [
                            70,
                            "  acl    = \"private\"\n"
                        ],
                        [
                            71,
                            "  versioning {\n"
                        ],
                        [
                            72,
                            "    enabled = true\n"
                        ],
                        [
                            73,
                            "  }\n"
                        ],
                        [
                            74,
                            "  force_destroy = true\n"
                        ],
                        [
                            75,
                            "  tags = merge({\n"
                        ],
                        [
                            76,
                            "    Name        = \"${local.resource_prefix.value}-operations\"\n"
                        ],
                        [
                            77,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            78,
                            "    }, {\n"
                        ],
                        [
                            79,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            80,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            81,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            82,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            83,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            84,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            85,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            86,
                            "    yor_trace            = \"29efcf7b-22a8-4bd6-8e14-1f55b3a2d743\"\n"
                        ],
                        [
                            87,
                            "  })\n"
                        ],
                        [
                            88,
                            "\n"
                        ],
                        [
                            89,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        66,
                        89
                    ],
                    "resource": "aws_s3_bucket.operations",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3Encryption",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-operations",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_18",
                    "bc_check_id": null,
                    "check_name": "Ensure the S3 bucket has access logging enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "logging"
                        ]
                    },
                    "code_block": [
                        [
                            66,
                            "resource \"aws_s3_bucket\" \"operations\" {\n"
                        ],
                        [
                            67,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            68,
                            "  # bucket does not have access logs\n"
                        ],
                        [
                            69,
                            "  bucket = \"${local.resource_prefix.value}-operations\"\n"
                        ],
                        [
                            70,
                            "  acl    = \"private\"\n"
                        ],
                        [
                            71,
                            "  versioning {\n"
                        ],
                        [
                            72,
                            "    enabled = true\n"
                        ],
                        [
                            73,
                            "  }\n"
                        ],
                        [
                            74,
                            "  force_destroy = true\n"
                        ],
                        [
                            75,
                            "  tags = merge({\n"
                        ],
                        [
                            76,
                            "    Name        = \"${local.resource_prefix.value}-operations\"\n"
                        ],
                        [
                            77,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            78,
                            "    }, {\n"
                        ],
                        [
                            79,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            80,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            81,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            82,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            83,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            84,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            85,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            86,
                            "    yor_trace            = \"29efcf7b-22a8-4bd6-8e14-1f55b3a2d743\"\n"
                        ],
                        [
                            87,
                            "  })\n"
                        ],
                        [
                            88,
                            "\n"
                        ],
                        [
                            89,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        66,
                        89
                    ],
                    "resource": "aws_s3_bucket.operations",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3AccessLogs",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-operations",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_144",
                    "bc_check_id": null,
                    "check_name": "Ensure that S3 bucket has cross-region replication enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "replication_configuration/[0]/role"
                        ]
                    },
                    "code_block": [
                        [
                            66,
                            "resource \"aws_s3_bucket\" \"operations\" {\n"
                        ],
                        [
                            67,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            68,
                            "  # bucket does not have access logs\n"
                        ],
                        [
                            69,
                            "  bucket = \"${local.resource_prefix.value}-operations\"\n"
                        ],
                        [
                            70,
                            "  acl    = \"private\"\n"
                        ],
                        [
                            71,
                            "  versioning {\n"
                        ],
                        [
                            72,
                            "    enabled = true\n"
                        ],
                        [
                            73,
                            "  }\n"
                        ],
                        [
                            74,
                            "  force_destroy = true\n"
                        ],
                        [
                            75,
                            "  tags = merge({\n"
                        ],
                        [
                            76,
                            "    Name        = \"${local.resource_prefix.value}-operations\"\n"
                        ],
                        [
                            77,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            78,
                            "    }, {\n"
                        ],
                        [
                            79,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            80,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            81,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            82,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            83,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            84,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            85,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            86,
                            "    yor_trace            = \"29efcf7b-22a8-4bd6-8e14-1f55b3a2d743\"\n"
                        ],
                        [
                            87,
                            "  })\n"
                        ],
                        [
                            88,
                            "\n"
                        ],
                        [
                            89,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        66,
                        89
                    ],
                    "resource": "aws_s3_bucket.operations",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3BucketReplicationConfiguration",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-operations",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_145",
                    "bc_check_id": null,
                    "check_name": "Ensure that S3 buckets are encrypted with KMS by default",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "server_side_encryption_configuration/[0]/rule/[0]/apply_server_side_encryption_by_default/[0]/sse_algorithm"
                        ]
                    },
                    "code_block": [
                        [
                            66,
                            "resource \"aws_s3_bucket\" \"operations\" {\n"
                        ],
                        [
                            67,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            68,
                            "  # bucket does not have access logs\n"
                        ],
                        [
                            69,
                            "  bucket = \"${local.resource_prefix.value}-operations\"\n"
                        ],
                        [
                            70,
                            "  acl    = \"private\"\n"
                        ],
                        [
                            71,
                            "  versioning {\n"
                        ],
                        [
                            72,
                            "    enabled = true\n"
                        ],
                        [
                            73,
                            "  }\n"
                        ],
                        [
                            74,
                            "  force_destroy = true\n"
                        ],
                        [
                            75,
                            "  tags = merge({\n"
                        ],
                        [
                            76,
                            "    Name        = \"${local.resource_prefix.value}-operations\"\n"
                        ],
                        [
                            77,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            78,
                            "    }, {\n"
                        ],
                        [
                            79,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            80,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            81,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            82,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            83,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            84,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            85,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            86,
                            "    yor_trace            = \"29efcf7b-22a8-4bd6-8e14-1f55b3a2d743\"\n"
                        ],
                        [
                            87,
                            "  })\n"
                        ],
                        [
                            88,
                            "\n"
                        ],
                        [
                            89,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        66,
                        89
                    ],
                    "resource": "aws_s3_bucket.operations",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3KMSEncryptedByDefault",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-operations",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_19",
                    "bc_check_id": null,
                    "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "server_side_encryption_configuration/[0]/rule/[0]/apply_server_side_encryption_by_default/[0]/sse_algorithm"
                        ]
                    },
                    "code_block": [
                        [
                            91,
                            "resource \"aws_s3_bucket\" \"data_science\" {\n"
                        ],
                        [
                            92,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            93,
                            "  bucket = \"${local.resource_prefix.value}-data-science\"\n"
                        ],
                        [
                            94,
                            "  acl    = \"private\"\n"
                        ],
                        [
                            95,
                            "  versioning {\n"
                        ],
                        [
                            96,
                            "    enabled = true\n"
                        ],
                        [
                            97,
                            "  }\n"
                        ],
                        [
                            98,
                            "  logging {\n"
                        ],
                        [
                            99,
                            "    target_bucket = \"${aws_s3_bucket.logs.id}\"\n"
                        ],
                        [
                            100,
                            "    target_prefix = \"log/\"\n"
                        ],
                        [
                            101,
                            "  }\n"
                        ],
                        [
                            102,
                            "  force_destroy = true\n"
                        ],
                        [
                            103,
                            "  tags = {\n"
                        ],
                        [
                            104,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            105,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            106,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            107,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            108,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            109,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            110,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            111,
                            "    yor_trace            = \"9a7c8788-5655-4708-bbc3-64ead9847f64\"\n"
                        ],
                        [
                            112,
                            "  }\n"
                        ],
                        [
                            113,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        91,
                        113
                    ],
                    "resource": "aws_s3_bucket.data_science",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3Encryption",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_144",
                    "bc_check_id": null,
                    "check_name": "Ensure that S3 bucket has cross-region replication enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "replication_configuration/[0]/role"
                        ]
                    },
                    "code_block": [
                        [
                            91,
                            "resource \"aws_s3_bucket\" \"data_science\" {\n"
                        ],
                        [
                            92,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            93,
                            "  bucket = \"${local.resource_prefix.value}-data-science\"\n"
                        ],
                        [
                            94,
                            "  acl    = \"private\"\n"
                        ],
                        [
                            95,
                            "  versioning {\n"
                        ],
                        [
                            96,
                            "    enabled = true\n"
                        ],
                        [
                            97,
                            "  }\n"
                        ],
                        [
                            98,
                            "  logging {\n"
                        ],
                        [
                            99,
                            "    target_bucket = \"${aws_s3_bucket.logs.id}\"\n"
                        ],
                        [
                            100,
                            "    target_prefix = \"log/\"\n"
                        ],
                        [
                            101,
                            "  }\n"
                        ],
                        [
                            102,
                            "  force_destroy = true\n"
                        ],
                        [
                            103,
                            "  tags = {\n"
                        ],
                        [
                            104,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            105,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            106,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            107,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            108,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            109,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            110,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            111,
                            "    yor_trace            = \"9a7c8788-5655-4708-bbc3-64ead9847f64\"\n"
                        ],
                        [
                            112,
                            "  }\n"
                        ],
                        [
                            113,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        91,
                        113
                    ],
                    "resource": "aws_s3_bucket.data_science",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3BucketReplicationConfiguration",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_145",
                    "bc_check_id": null,
                    "check_name": "Ensure that S3 buckets are encrypted with KMS by default",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "server_side_encryption_configuration/[0]/rule/[0]/apply_server_side_encryption_by_default/[0]/sse_algorithm"
                        ]
                    },
                    "code_block": [
                        [
                            91,
                            "resource \"aws_s3_bucket\" \"data_science\" {\n"
                        ],
                        [
                            92,
                            "  # bucket is not encrypted\n"
                        ],
                        [
                            93,
                            "  bucket = \"${local.resource_prefix.value}-data-science\"\n"
                        ],
                        [
                            94,
                            "  acl    = \"private\"\n"
                        ],
                        [
                            95,
                            "  versioning {\n"
                        ],
                        [
                            96,
                            "    enabled = true\n"
                        ],
                        [
                            97,
                            "  }\n"
                        ],
                        [
                            98,
                            "  logging {\n"
                        ],
                        [
                            99,
                            "    target_bucket = \"${aws_s3_bucket.logs.id}\"\n"
                        ],
                        [
                            100,
                            "    target_prefix = \"log/\"\n"
                        ],
                        [
                            101,
                            "  }\n"
                        ],
                        [
                            102,
                            "  force_destroy = true\n"
                        ],
                        [
                            103,
                            "  tags = {\n"
                        ],
                        [
                            104,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            105,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            106,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            107,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            108,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            109,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            110,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            111,
                            "    yor_trace            = \"9a7c8788-5655-4708-bbc3-64ead9847f64\"\n"
                        ],
                        [
                            112,
                            "  }\n"
                        ],
                        [
                            113,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        91,
                        113
                    ],
                    "resource": "aws_s3_bucket.data_science",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3KMSEncryptedByDefault",
                    "fixed_definition": null,
                    "entity_tags": {
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-16 14:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_18",
                    "bc_check_id": null,
                    "check_name": "Ensure the S3 bucket has access logging enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "logging"
                        ]
                    },
                    "code_block": [
                        [
                            115,
                            "resource \"aws_s3_bucket\" \"logs\" {\n"
                        ],
                        [
                            116,
                            "  bucket = \"${local.resource_prefix.value}-logs\"\n"
                        ],
                        [
                            117,
                            "  acl    = \"log-delivery-write\"\n"
                        ],
                        [
                            118,
                            "  versioning {\n"
                        ],
                        [
                            119,
                            "    enabled = true\n"
                        ],
                        [
                            120,
                            "  }\n"
                        ],
                        [
                            121,
                            "  server_side_encryption_configuration {\n"
                        ],
                        [
                            122,
                            "    rule {\n"
                        ],
                        [
                            123,
                            "      apply_server_side_encryption_by_default {\n"
                        ],
                        [
                            124,
                            "        sse_algorithm     = \"aws:kms\"\n"
                        ],
                        [
                            125,
                            "        kms_master_key_id = \"${aws_kms_key.logs_key.arn}\"\n"
                        ],
                        [
                            126,
                            "      }\n"
                        ],
                        [
                            127,
                            "    }\n"
                        ],
                        [
                            128,
                            "  }\n"
                        ],
                        [
                            129,
                            "  force_destroy = true\n"
                        ],
                        [
                            130,
                            "  tags = merge({\n"
                        ],
                        [
                            131,
                            "    Name        = \"${local.resource_prefix.value}-logs\"\n"
                        ],
                        [
                            132,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            133,
                            "    }, {\n"
                        ],
                        [
                            134,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            135,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            136,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            137,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            138,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            139,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            140,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            141,
                            "    yor_trace            = \"01946fe9-aae2-4c99-a975-e9b0d3a4696c\"\n"
                        ],
                        [
                            142,
                            "  })\n"
                        ],
                        [
                            143,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        115,
                        143
                    ],
                    "resource": "aws_s3_bucket.logs",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3AccessLogs",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-logs",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                },
                {
                    "check_id": "CKV_AWS_144",
                    "bc_check_id": null,
                    "check_name": "Ensure that S3 bucket has cross-region replication enabled",
                    "check_result": {
                        "result": "FAILED",
                        "evaluated_keys": [
                            "replication_configuration/[0]/role"
                        ]
                    },
                    "code_block": [
                        [
                            115,
                            "resource \"aws_s3_bucket\" \"logs\" {\n"
                        ],
                        [
                            116,
                            "  bucket = \"${local.resource_prefix.value}-logs\"\n"
                        ],
                        [
                            117,
                            "  acl    = \"log-delivery-write\"\n"
                        ],
                        [
                            118,
                            "  versioning {\n"
                        ],
                        [
                            119,
                            "    enabled = true\n"
                        ],
                        [
                            120,
                            "  }\n"
                        ],
                        [
                            121,
                            "  server_side_encryption_configuration {\n"
                        ],
                        [
                            122,
                            "    rule {\n"
                        ],
                        [
                            123,
                            "      apply_server_side_encryption_by_default {\n"
                        ],
                        [
                            124,
                            "        sse_algorithm     = \"aws:kms\"\n"
                        ],
                        [
                            125,
                            "        kms_master_key_id = \"${aws_kms_key.logs_key.arn}\"\n"
                        ],
                        [
                            126,
                            "      }\n"
                        ],
                        [
                            127,
                            "    }\n"
                        ],
                        [
                            128,
                            "  }\n"
                        ],
                        [
                            129,
                            "  force_destroy = true\n"
                        ],
                        [
                            130,
                            "  tags = merge({\n"
                        ],
                        [
                            131,
                            "    Name        = \"${local.resource_prefix.value}-logs\"\n"
                        ],
                        [
                            132,
                            "    Environment = local.resource_prefix.value\n"
                        ],
                        [
                            133,
                            "    }, {\n"
                        ],
                        [
                            134,
                            "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"
                        ],
                        [
                            135,
                            "    git_file             = \"terraform/aws/s3.tf\"\n"
                        ],
                        [
                            136,
                            "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"
                        ],
                        [
                            137,
                            "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"
                        ],
                        [
                            138,
                            "    git_modifiers        = \"nimrodkor\"\n"
                        ],
                        [
                            139,
                            "    git_org              = \"bridgecrewio\"\n"
                        ],
                        [
                            140,
                            "    git_repo             = \"terragoat\"\n"
                        ],
                        [
                            141,
                            "    yor_trace            = \"01946fe9-aae2-4c99-a975-e9b0d3a4696c\"\n"
                        ],
                        [
                            142,
                            "  })\n"
                        ],
                        [
                            143,
                            "}\n"
                        ]
                    ],
                    "file_path": "/s3.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/s3.tf",
                    "repo_file_path": "/terragoat/terraform/aws/s3.tf",
                    "file_line_range": [
                        115,
                        143
                    ],
                    "resource": "aws_s3_bucket.logs",
                    "evaluations": null,
                    "check_class": "checkov.terraform.checks.resource.aws.S3BucketReplicationConfiguration",
                    "fixed_definition": null,
                    "entity_tags": {
                        "Name": "data.aws_caller_identity.current.account_id-acme-dev-logs",
                        "Environment": "data.aws_caller_identity.current.account_id-acme-dev",
                        "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0",
                        "git_file": "terraform/aws/s3.tf",
                        "git_last_modified_at": "2020-06-1614:46:24",
                        "git_last_modified_by": "nimrodkor@gmail.com",
                        "git_modifiers": "nimrodkor",
                        "git_org": "bridgecrewio",
                        "git_repo": "terragoat",
                        "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"
                    },
                    "caller_file_path": null,
                    "caller_file_line_range": null,
                    "breadcrumbs": {
                        "tags": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ],
                        "bucket": [
                            {
                                "type": "locals",
                                "name": "resource_prefix",
                                "path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/consts.tf",
                                "module_connection": false
                            }
                        ]
                    }
                }
            ]
        },
        "summary": {
            "passed": 64,
            "failed": 76,
            "skipped": 0,
            "parsing_errors": 0,
            "resource_count": 55,
            "checkov_version": "2.0.480"
        }
    },
    {
        "check_type": "dockerfile",
        "results": {
            "failed_checks": [
                {
                    "check_id": "CKV_DOCKER_2",
                    "bc_check_id": null,
                    "check_name": "Ensure that HEALTHCHECK instructions have been added to container images",
                    "check_result": {
                        "result": "FAILED",
                        "results_configuration": null
                    },
                    "code_block": [
                        [
                            1,
                            "FROM python:3.7-slim\n"
                        ]
                    ],
                    "file_path": "/resources/Dockerfile",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/resources/Dockerfile",
                    "repo_file_path": "/terragoat/terraform/aws/resources/Dockerfile",
                    "file_line_range": [
                        1,
                        1
                    ],
                    "resource": "/resources/Dockerfile.",
                    "evaluations": null,
                    "check_class": "checkov.dockerfile.checks.HealthcheckExists",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null
                },
                {
                    "check_id": "CKV_DOCKER_3",
                    "bc_check_id": null,
                    "check_name": "Ensure that a user for the container has been created",
                    "check_result": {
                        "result": "FAILED",
                        "results_configuration": null
                    },
                    "code_block": [
                        [
                            1,
                            "FROM python:3.7-slim\n"
                        ]
                    ],
                    "file_path": "/resources/Dockerfile",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/resources/Dockerfile",
                    "repo_file_path": "/terragoat/terraform/aws/resources/Dockerfile",
                    "file_line_range": [
                        1,
                        1
                    ],
                    "resource": "/resources/Dockerfile.",
                    "evaluations": null,
                    "check_class": "checkov.dockerfile.checks.UserExists",
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null
                }
            ]
        },
        "summary": {
            "passed": 1,
            "failed": 2,
            "skipped": 0,
            "parsing_errors": 0,
            "resource_count": 1,
            "checkov_version": "2.0.480"
        }
    },
    {
        "check_type": "secrets",
        "results": {
            "failed_checks": [
                {
                    "check_id": "CKV_SECRET_2",
                    "bc_check_id": "BC_GIT_2",
                    "check_name": "AWS Access Key",
                    "check_result": {
                        "result": "FAILED"
                    },
                    "code_block": [
                        [
                            44,
                            "      access_key = \"AKIAIOSFODNN7EXAMPLE\"\n"
                        ]
                    ],
                    "file_path": "/lambda.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/lambda.tf",
                    "repo_file_path": "/terragoat/terraform/aws/lambda.tf",
                    "file_line_range": [
                        44,
                        45
                    ],
                    "resource": "25910f981e85ca04baf359199dd0bd4a3ae738b6",
                    "evaluations": null,
                    "check_class": null,
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null
                },
                {
                    "check_id": "CKV_SECRET_6",
                    "bc_check_id": "BC_GIT_6",
                    "check_name": "Base64 High Entropy String",
                    "check_result": {
                        "result": "FAILED"
                    },
                    "code_block": [
                        [
                            45,
                            "      secret_key = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n"
                        ]
                    ],
                    "file_path": "/lambda.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/lambda.tf",
                    "repo_file_path": "/terragoat/terraform/aws/lambda.tf",
                    "file_line_range": [
                        45,
                        46
                    ],
                    "resource": "d70eab08607a4d05faa2d0d6647206599e9abc65",
                    "evaluations": null,
                    "check_class": null,
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null
                },
                {
                    "check_id": "CKV_SECRET_2",
                    "bc_check_id": "BC_GIT_2",
                    "check_name": "AWS Access Key",
                    "check_result": {
                        "result": "FAILED"
                    },
                    "code_block": [
                        [
                            10,
                            "  access_key = \"AKIAIOSFODNN7EXAMPLE\"\n"
                        ]
                    ],
                    "file_path": "/providers.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/providers.tf",
                    "repo_file_path": "/terragoat/terraform/aws/providers.tf",
                    "file_line_range": [
                        10,
                        11
                    ],
                    "resource": "25910f981e85ca04baf359199dd0bd4a3ae738b6",
                    "evaluations": null,
                    "check_class": null,
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null
                },
                {
                    "check_id": "CKV_SECRET_6",
                    "bc_check_id": "BC_GIT_6",
                    "check_name": "Base64 High Entropy String",
                    "check_result": {
                        "result": "FAILED"
                    },
                    "code_block": [
                        [
                            11,
                            "  secret_key = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n"
                        ]
                    ],
                    "file_path": "/providers.tf",
                    "file_abs_path": "/Users/kmcquade/Code/github.com/kmcquade/terraform-aws-vulnerable/terragoat/terraform/aws/providers.tf",
                    "repo_file_path": "/terragoat/terraform/aws/providers.tf",
                    "file_line_range": [
                        11,
                        12
                    ],
                    "resource": "d70eab08607a4d05faa2d0d6647206599e9abc65",
                    "evaluations": null,
                    "check_class": null,
                    "fixed_definition": null,
                    "entity_tags": null,
                    "caller_file_path": null,
                    "caller_file_line_range": null
                }
            ]
        },
        "summary": {
            "passed": 0,
            "failed": 4,
            "skipped": 0,
            "parsing_errors": 0,
            "resource_count": 4,
            "checkov_version": "2.0.480"
        }
    }
]
